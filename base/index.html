
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../solvers/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.13">
    
    
      
        <title>Base Classes - MINIMOD Optimization Tool</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ffa9267a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#base-classes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MINIMOD Optimization Tool" class="md-header__button md-logo" aria-label="MINIMOD Optimization Tool" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MINIMOD Optimization Tool
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Base Classes
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/minimod-nutrition/minimod-opt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Base Classes
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../solvers/" class="md-tabs__link">
      Solvers
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../monte_carlo/" class="md-tabs__link">
      Monte Carlo
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../utils/" class="md-tabs__link">
      Utility Classes
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MINIMOD Optimization Tool" class="md-nav__button md-logo" aria-label="MINIMOD Optimization Tool" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MINIMOD Optimization Tool
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/minimod-nutrition/minimod-opt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Base Classes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Base Classes
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.model" class="md-nav__link">
    minimod_opt.base.model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model" class="md-nav__link">
    Model
  </a>
  
    <nav class="md-nav" aria-label="Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.add_constraint" class="md-nav__link">
    add_constraint()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.add_objective" class="md-nav__link">
    add_objective()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.base_model_create" class="md-nav__link">
    base_model_create()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.get_equation" class="md-nav__link">
    get_equation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.get_model_results" class="md-nav__link">
    get_model_results()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.optimize" class="md-nav__link">
    optimize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.process_results" class="md-nav__link">
    process_results()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.write" class="md-nav__link">
    write()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver" class="md-nav__link">
    minimod_opt.base.basesolver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver" class="md-nav__link">
    BaseSolver
  </a>
  
    <nav class="md-nav" aria-label="BaseSolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.bau_list" class="md-nav__link">
    bau_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_bau_time" class="md-nav__link">
    plot_bau_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_chloropleth" class="md-nav__link">
    plot_chloropleth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_grouped_interventions" class="md-nav__link">
    plot_grouped_interventions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_map_benchmark" class="md-nav__link">
    plot_map_benchmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_opt_val_hist" class="md-nav__link">
    plot_opt_val_hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_time" class="md-nav__link">
    plot_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.process_results" class="md-nav__link">
    process_results()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.report" class="md-nav__link">
    report()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.write" class="md-nav__link">
    write()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint" class="md-nav__link">
    minimod_opt.base.bau_constraint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint.BAUConstraintCreator" class="md-nav__link">
    BAUConstraintCreator
  </a>
  
    <nav class="md-nav" aria-label="BAUConstraintCreator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint.BAUConstraintCreator.bau_df" class="md-nav__link">
    bau_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint.BAUConstraintCreator.create_bau_constraint" class="md-nav__link">
    create_bau_constraint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../solvers/" class="md-nav__link">
        Solvers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../monte_carlo/" class="md-nav__link">
        Monte Carlo
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utility Classes
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.model" class="md-nav__link">
    minimod_opt.base.model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model" class="md-nav__link">
    Model
  </a>
  
    <nav class="md-nav" aria-label="Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.add_constraint" class="md-nav__link">
    add_constraint()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.add_objective" class="md-nav__link">
    add_objective()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.base_model_create" class="md-nav__link">
    base_model_create()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.get_equation" class="md-nav__link">
    get_equation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.get_model_results" class="md-nav__link">
    get_model_results()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.optimize" class="md-nav__link">
    optimize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.process_results" class="md-nav__link">
    process_results()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.model.Model.write" class="md-nav__link">
    write()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver" class="md-nav__link">
    minimod_opt.base.basesolver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver" class="md-nav__link">
    BaseSolver
  </a>
  
    <nav class="md-nav" aria-label="BaseSolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.bau_list" class="md-nav__link">
    bau_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_bau_time" class="md-nav__link">
    plot_bau_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_chloropleth" class="md-nav__link">
    plot_chloropleth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_grouped_interventions" class="md-nav__link">
    plot_grouped_interventions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_map_benchmark" class="md-nav__link">
    plot_map_benchmark()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_opt_val_hist" class="md-nav__link">
    plot_opt_val_hist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.plot_time" class="md-nav__link">
    plot_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.process_results" class="md-nav__link">
    process_results()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.report" class="md-nav__link">
    report()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.basesolver.BaseSolver.write" class="md-nav__link">
    write()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint" class="md-nav__link">
    minimod_opt.base.bau_constraint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint.BAUConstraintCreator" class="md-nav__link">
    BAUConstraintCreator
  </a>
  
    <nav class="md-nav" aria-label="BAUConstraintCreator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint.BAUConstraintCreator.bau_df" class="md-nav__link">
    bau_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#minimod_opt.base.bau_constraint.BAUConstraintCreator.create_bau_constraint" class="md-nav__link">
    create_bau_constraint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="base-classes">Base Classes</h1>


<div class="doc doc-object doc-module">


<a id="minimod_opt.base.model"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="minimod_opt.base.model.Model" class="doc doc-heading">
        <code>Model</code>


</h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">sense</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">solver_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">show_output</span><span class="p">:</span><span class="nb">bool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A class that instantiates a `mip` model.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.DataFrame): The input dataframe that includes benefit/cost data</span>
<span class="sd">            sense (str): Whether the model should minimize (MINIMIZE) or maximize (MAXIMIZE)</span>
<span class="sd">            solver_name (str): The solver type (CBC or some other mip solver)</span>
<span class="sd">            show_output (bool):  Whether to show output of model construction</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="c1">## Tell the fitter whether to maximize or minimize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">mip</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">sense</span><span class="o">=</span><span class="n">sense</span><span class="p">,</span> <span class="n">solver_name</span><span class="o">=</span><span class="n">solver_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">data</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span> <span class="o">=</span> <span class="n">show_output</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">## set tolerances based on GAMS tolerances</span>
        <span class="c1"># primal tol -&gt; infeas</span>
        <span class="c1"># dual tol -&gt; opt tol</span>
        <span class="c1"># integer  tol -&gt; integer_tol</span>
        <span class="c1"># self.model.opt_tol = 1e-10</span>
        <span class="c1"># self.model.infeas_tol = 1e-10</span>
        <span class="c1"># self.model.integer_tol = 1e-06</span>
        <span class="c1"># self.model.seed = 0</span>
        <span class="c1"># # self.model.clique = 0</span>

        <span class="c1"># # # # # allowable gap/ optca -&gt; max_mip_gap_abs</span>
        <span class="c1"># # # # # ratioGap/ optcr -&gt; max_mip_gap</span>

        <span class="c1"># self.model.max_mip_gap_abs = 0</span>
        <span class="c1"># self.model.max_mip_gap = 0.1</span>

        <span class="c1"># self.model.preprocess = 0</span>
        <span class="c1"># self.model.lp_method = -1</span>
        <span class="c1"># self.cut_passes = 1</span>

    <span class="k">def</span> <span class="nf">_stringify_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tup</span><span class="p">:</span><span class="nb">tuple</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function converts all the items of a tuple into one string</span>

<span class="sd">        Args:</span>
<span class="sd">            tup (tuple): general tuple </span>

<span class="sd">        Returns:</span>
<span class="sd">            str: output string generated from all items in the tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tup</span><span class="p">]</span>

        <span class="n">stringified</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">stringified</span>

    <span class="k">def</span> <span class="nf">_model_var_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_var</span><span class="p">(</span>
                <span class="n">var_type</span><span class="o">=</span><span class="n">mip</span><span class="o">.</span><span class="n">BINARY</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_stringify_tuple</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_base_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constraint making the &#39;ones&#39; constraint, making an intervention a binary intervention.</span>

<span class="sd">        Args:</span>
<span class="sd">            space (str): name of dataframe&#39;s column with information on regions/locations</span>
<span class="sd">            time (str): name of dataframe&#39;s column with information on time/years</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grouped_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mip</span><span class="o">.</span><span class="n">xsum</span><span class="p">)</span>

        <span class="n">base_constrs</span> <span class="o">=</span> <span class="n">grouped_df</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Get constraint name</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stringify_tuple</span><span class="p">,</span>
                <span class="n">grouped_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">constr</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">base_constrs</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">constr</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;ones_&quot;</span> <span class="o">+</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_intervention_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intervention</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span> <span class="n">subset_names</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span><span class="p">[])</span><span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function creates a dictionary for the subset of specified interventions</span>

<span class="sd">        Args:</span>
<span class="sd">            intervention (str): name of dataframe&#39;s column with set of interventions </span>
<span class="sd">            strict (bool): whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains)</span>
<span class="sd">            subset_names (list, optional): Which intervention names to look for. Defaults to [].</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: dictionary with subset of interventions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">subset_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subset_names</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
                <span class="n">subset_dict</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                    <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">intervention</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">])</span>
                <span class="p">]</span>

                <span class="k">if</span> <span class="n">subset_dict</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; not found in dataset.&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">subset_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                    <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">intervention</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">]</span>

                <span class="k">if</span> <span class="n">subset_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#39; not found in dataset.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">subset_dict</span>

    <span class="k">def</span> <span class="nf">_all_constraint</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
        <span class="n">intervention</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subset_names</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">over</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subset_list</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A constraint across space or time, where an intervention is tied to other interventions across space time (for a given subset). For instance, if you wanted to</span>
<span class="sd">        create a national intervention, for some intervention X, with 2 regions, this constraint would do the following:</span>

<span class="sd">        $X_{region1,t} == X_{region2,t}$ -&gt; _all_constraint(over=&#39;space&#39;, subset_names=None)</span>

<span class="sd">        If you wanted to make sure that interventions were tied across time so that period 2 could only be used if period 1 was used:</span>

<span class="sd">        $X_{region1, 1} == X_{region1, 2}$</span>

<span class="sd">        Args:</span>
<span class="sd">            strict (bool): whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains)</span>
<span class="sd">            intervention (str, optional): name of dataframe&#39;s column with set of interventions. Defaults to None.</span>
<span class="sd">            space (str, optional): name of dataframe&#39;s column with information on regions/locations. Defaults to None.</span>
<span class="sd">            time (str, optional): name of dataframe&#39;s column with information on time/year. Defaults to None.</span>
<span class="sd">            subset_names (list, optional): Which intervention names to look for. Defaults to None.</span>
<span class="sd">            over (str, optional): name of dataframe&#39;s column  with attribute used to group data by (e.g., time, region). Defaults to None.</span>
<span class="sd">            subset_list (list, optional): A list of interventions that are being constrained. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">subset_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intervention_subset</span><span class="p">(</span>
            <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">,</span> <span class="n">subset_names</span><span class="o">=</span><span class="n">subset_names</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">subset_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="n">mip_vars_grouped_sum</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">subset_dict</span><span class="p">[</span><span class="n">sub</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">])[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mip</span><span class="o">.</span><span class="n">xsum</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">over</span> <span class="o">==</span> <span class="n">time</span><span class="p">:</span>
                <span class="n">slicer</span> <span class="o">=</span> <span class="n">space</span>
            <span class="k">elif</span> <span class="n">over</span> <span class="o">==</span> <span class="n">space</span><span class="p">:</span>
                <span class="n">slicer</span> <span class="o">=</span> <span class="n">time</span>

            <span class="n">unstacked</span> <span class="o">=</span> <span class="n">mip_vars_grouped_sum</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">slicer</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">subset_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">subset_list</span> <span class="o">=</span> <span class="n">unstacked</span><span class="o">.</span><span class="n">index</span>

            <span class="c1"># get combinations of different choices</span>
            <span class="n">constraint_combinations</span> <span class="o">=</span> <span class="n">permutations</span><span class="p">(</span><span class="n">unstacked</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">constraint_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">constraint_combinations</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subset_list</span>
            <span class="p">]</span>

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">unstacked</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">comb1</span><span class="p">,</span> <span class="n">comb2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">constraint_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span>
                        <span class="n">unstacked</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">comb1</span><span class="p">],</span> <span class="n">unstacked</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">comb2</span><span class="p">],</span> 
                        <span class="s2">&quot;eq&quot;</span><span class="p">,</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">comb1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">comb2</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_all_space_constraint</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
        <span class="n">intervention</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subset_names</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">over</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subset_list</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span><span class="o">-&gt;</span><span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function invokes the function `_all_constraint&#39; to create national interventions</span>

<span class="sd">        Args:</span>
<span class="sd">            strict (bool): whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains)</span>
<span class="sd">            intervention (str, optional): name of dataframe&#39;s column with set of interventions. Defaults to None.</span>
<span class="sd">            space (str, optional): name of dataframe&#39;s column with informaiton on regions/locations. Defaults to None.</span>
<span class="sd">            time (str, optional): name of dataframe&#39;s column with information on time/year. Defaults to None.</span>
<span class="sd">            subset_names (list, optional): Which intervention names to look for. Defaults to None.</span>
<span class="sd">            over (str, optional): name of dataframe&#39;s column  with attribute used to group data by (e.g., time, region). Defaults to None.</span>
<span class="sd">            subset_list (list, optional): A list of interventions that are being constrained. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_constraint</span><span class="p">(</span>
            <span class="n">strict</span><span class="p">,</span>
            <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">subset_names</span><span class="o">=</span><span class="n">subset_names</span><span class="p">,</span>
            <span class="n">over</span><span class="o">=</span><span class="n">over</span><span class="p">,</span>
            <span class="n">subset_list</span><span class="o">=</span><span class="n">subset_list</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_all_time_constraint</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span>
        <span class="n">intervention</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subset_names</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">over</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subset_list</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span><span class="o">-&gt;</span><span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function invokes the function `_all_constraint&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            strict (bool): whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains)</span>
<span class="sd">            intervention (str, optional): name of dataframe&#39;s column with set of interventions. Defaults to None.</span>
<span class="sd">            space (str, optional): name of dataframe&#39;s column with information on regions/locations. Defaults to None.</span>
<span class="sd">            time (str, optional): name of dataframe&#39;s column with information on time/year. Defaults to None.</span>
<span class="sd">            subset_names (list, optional): Which intervention names to look for. Defaults to None.</span>
<span class="sd">            over (str, optional): name of dataframe&#39;s column  with attribute used to group data by (e.g., time, region). Defaults to None.</span>
<span class="sd">            subset_list (list, optional): A list of interventions that are being constrained. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_constraint</span><span class="p">(</span>
            <span class="n">strict</span><span class="p">,</span>
            <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">subset_names</span><span class="o">=</span><span class="n">subset_names</span><span class="p">,</span>
            <span class="n">over</span><span class="o">=</span><span class="n">over</span><span class="p">,</span>
            <span class="n">subset_list</span><span class="o">=</span><span class="n">subset_list</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_equation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span> <span class="ow">or</span> <span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span> <span class="ow">or</span> <span class="n">mip</span><span class="o">.</span><span class="n">Constr</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function returns a constraint by its name. If no name is specified, returns all constraints</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str, optional): a string corresponding to the name of the constraint. Defaults to None.</span>
<span class="sd">            show (bool, optional): whether to return the contraint in string type or not. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str or mip.LinExpr or mip.Constr: A `mip` constraint object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">constrs</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;objective&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">constr_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">constr_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eq</span><span class="p">:</span><span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the objective function of the problem as a linear expression</span>

<span class="sd">        Args:</span>
<span class="sd">            eq (mip.LinExpr): equation defining the objective function</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">eq</span>

    <span class="k">def</span> <span class="nf">add_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eq</span><span class="p">:</span><span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span><span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">,</span> <span class="n">way</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ge&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function merges the objective function of the model with its constraint</span>

<span class="sd">        Args:</span>
<span class="sd">            eq (mip.LinExpr): equation defining the objective function</span>
<span class="sd">            constraint (mip.LinExpr):equation defining the constraint function</span>
<span class="sd">            way (str, optional): whether greater or equal (ge), less or equal(le), or equal(eq). Defaults to &quot;ge&quot;.</span>
<span class="sd">            name (str, optional): optional name for the constraint. Defaults to &quot;&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="c1"># Merge equation with constraint</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ee</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;ge&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">ee</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">,</span> <span class="n">name</span>
                <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;le&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">ee</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">,</span> <span class="n">name</span>
                <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;eq&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">ee</span> <span class="o">==</span> <span class="n">c</span><span class="p">,</span> <span class="n">name</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;ge&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">eq</span> <span class="o">&gt;=</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">name</span>
            <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;le&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">eq</span> <span class="o">&lt;=</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">name</span>
            <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;eq&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">eq</span> <span class="o">==</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">base_model_create</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">intervention</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">all_time</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">all_space</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time_subset</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">space_subset</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A function   </span>

<span class="sd">        Args:</span>
<span class="sd">            intervention (str): name of dataframe&#39;s column with set of interventions</span>
<span class="sd">            space (str): name of dataframe&#39;s column with information on regions/locations</span>
<span class="sd">            time (str): name of dataframe&#39;s column with information on time/years</span>
<span class="sd">            all_time (list, optional): list of intervention vehicles that are active during all periods (e.g., cube, oil). Defaults to None.</span>
<span class="sd">            all_space (list, optional): list of intervention vehicles that are targeted at a country-wide level (e.g., cube, oil). Defaults to None.</span>
<span class="sd">            time_subset (list, optional): list with subset of periods. Defaults to None.</span>
<span class="sd">            space_subset (list, optional):list with subset of regions/locations. Defaults to None.</span>
<span class="sd">            strict (bool, optional): whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains). Defaults to False.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">## Now we create the choice variable, x, which is binary and is the size of the dataset.</span>
        <span class="c1">## In this case, it should just be a column vector with the rows equal to the data:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_model_var_create</span><span class="p">()</span>

        <span class="c1">## First add base constraint, which only allows one intervention per time and space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_base_constraint</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

        <span class="c1">## Add all_space or all_time constraints if necessary</span>
        <span class="k">if</span> <span class="n">all_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;One of the subset columns were not found&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_all_time_constraint</span><span class="p">(</span>
                <span class="n">strict</span><span class="p">,</span>
                <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span>
                <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
                <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                <span class="n">subset_names</span><span class="o">=</span><span class="n">all_time</span><span class="p">,</span>
                <span class="n">over</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                <span class="n">subset_list</span><span class="o">=</span><span class="n">time_subset</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">all_space</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;One of the subset columns were not found&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_all_space_constraint</span><span class="p">(</span>
                <span class="n">strict</span><span class="p">,</span>
                <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span>
                <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
                <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                <span class="n">subset_names</span><span class="o">=</span><span class="n">all_space</span><span class="p">,</span>
                <span class="n">over</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
                <span class="n">subset_list</span><span class="o">=</span><span class="n">space_subset</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function conducts the optimization procedure </span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: Other parameters for optimization procedure using `mip.optimize&#39; (max_seconds, max_nodes, max_solutions)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_cols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoVars</span><span class="p">(</span><span class="s2">&quot;No Variables added to the model&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoConstraints</span><span class="p">(</span><span class="s2">&quot;No constraints added to the model.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoObjective</span><span class="p">(</span><span class="s2">&quot;No Objective added to the model&quot;</span><span class="p">)</span>

        <span class="c1"># Now, allow for arguments to the optimize function to be given:</span>

        <span class="n">max_seconds</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_seconds&quot;</span><span class="p">,</span> <span class="n">mip</span><span class="o">.</span><span class="n">INF</span><span class="p">)</span>
        <span class="n">max_nodes</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_nodes&quot;</span><span class="p">,</span> <span class="n">mip</span><span class="o">.</span><span class="n">INF</span><span class="p">)</span>
        <span class="n">max_solutions</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_solutions&quot;</span><span class="p">,</span> <span class="n">mip</span><span class="o">.</span><span class="n">INF</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">max_seconds</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_solutions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">suppress_stdout_stderr</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">max_seconds</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_solutions</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Optimal Solution Found&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">FEASIBLE</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Feasible Solution Found. This may not be optimal.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">NO_SOLUTION_FOUND</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Warning]: No Solution Found&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">INFEASIBLE</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Warning]: Infeasible Solution Found&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">benefit_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">cost_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">intervention_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">space_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">sol_num</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function creates a dataframe with information on benefits and costs for the optimal interventions</span>

<span class="sd">        Args:</span>
<span class="sd">            benefit_col (str): name of dataframe&#39;s column with benefits</span>
<span class="sd">            cost_col (str): name of dataframe&#39;s column with costs</span>
<span class="sd">            intervention_col (str): name of dataframe&#39;s column with set of interventions</span>
<span class="sd">            space_col (str): name of dataframe&#39;s column with information on regions/locations</span>
<span class="sd">            sol_num (int, optional): index of solution. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: dataframe with optimal interventions</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol_num</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">opt_vals</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="n">sol_num</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
                <span class="n">opt_vals</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

        <span class="n">opt_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">opt_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">opt_benefit</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">benefit_col</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">],</span>
            <span class="n">opt_costs</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">cost_col</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">],</span>
            <span class="n">opt_costs_discounted</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;discounted_costs&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">],</span>
            <span class="n">opt_benefit_discounted</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;discounted_benefits&quot;</span><span class="p">]</span><span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">])</span>
                  <span class="o">.</span><span class="n">infer_objects</span><span class="p">()</span>
                  <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">cumulative_discounted_benefits</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                         <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_benefit_discounted&#39;</span><span class="p">]</span>
                                                         <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)),</span>
            <span class="n">cumulative_discounted_costs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                         <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_costs_discounted&#39;</span><span class="p">]</span>
                                                         <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)),</span>
            <span class="n">cumulative_benefits</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                         <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_benefit&#39;</span><span class="p">]</span>
                                                         <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)),</span>
            <span class="n">cumulative_costs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                         <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_costs&#39;</span><span class="p">]</span>
                                                         <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">))</span>
        <span class="p">)[</span>
            <span class="p">[</span>
                <span class="s2">&quot;opt_vals&quot;</span><span class="p">,</span>
                <span class="s2">&quot;opt_benefit&quot;</span><span class="p">,</span>
                <span class="s2">&quot;opt_costs&quot;</span><span class="p">,</span>
                <span class="s2">&quot;opt_costs_discounted&quot;</span><span class="p">,</span>
                <span class="s2">&quot;opt_benefit_discounted&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cumulative_discounted_benefits&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cumulative_discounted_costs&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cumulative_benefits&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cumulative_costs&quot;</span>
                <span class="p">]</span>
        <span class="p">])</span>


        <span class="k">return</span> <span class="n">opt_df</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;model.lp&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thi function saves model to file</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str, optional): name of file. Defaults to &quot;model.lp&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_model_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function returns a list with additional results of the optimization procedure</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: model&#39;s results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective_value</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective_values</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective_bound</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_solutions</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_cols</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_int</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_nz</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sense</span><span class="p">,</span> <span class="n">solver_name</span><span class="p">,</span> <span class="n">show_output</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A class that instantiates a <code>mip</code> model.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>The input dataframe that includes benefit/cost data</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sense</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Whether the model should minimize (MINIMIZE) or maximize (MAXIMIZE)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>solver_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The solver type (CBC or some other mip solver)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>show_output</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to show output of model construction</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">sense</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">solver_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">show_output</span><span class="p">:</span><span class="nb">bool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class that instantiates a `mip` model.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.DataFrame): The input dataframe that includes benefit/cost data</span>
<span class="sd">        sense (str): Whether the model should minimize (MINIMIZE) or maximize (MAXIMIZE)</span>
<span class="sd">        solver_name (str): The solver type (CBC or some other mip solver)</span>
<span class="sd">        show_output (bool):  Whether to show output of model construction</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1">## Tell the fitter whether to maximize or minimize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">mip</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">sense</span><span class="o">=</span><span class="n">sense</span><span class="p">,</span> <span class="n">solver_name</span><span class="o">=</span><span class="n">solver_name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="n">data</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span> <span class="o">=</span> <span class="n">show_output</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.add_constraint" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_constraint</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">way</span><span class="o">=</span><span class="s1">&#39;ge&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function merges the objective function of the model with its constraint</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>eq</code></td>
          <td>
                <code>mip.<span title="mip.LinExpr">LinExpr</span></code>
          </td>
          <td><p>equation defining the objective function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>constraint</code></td>
          <td>
                <code>mip.<span title="mip.LinExpr">LinExpr</span></code>
          </td>
          <td><p>equation defining the constraint function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>way</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>whether greater or equal (ge), less or equal(le), or equal(eq). Defaults to "ge".</p></td>
          <td>
                <code>&#39;ge&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>optional name for the constraint. Defaults to "".</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eq</span><span class="p">:</span><span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span><span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">,</span> <span class="n">way</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ge&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function merges the objective function of the model with its constraint</span>

<span class="sd">    Args:</span>
<span class="sd">        eq (mip.LinExpr): equation defining the objective function</span>
<span class="sd">        constraint (mip.LinExpr):equation defining the constraint function</span>
<span class="sd">        way (str, optional): whether greater or equal (ge), less or equal(le), or equal(eq). Defaults to &quot;ge&quot;.</span>
<span class="sd">        name (str, optional): optional name for the constraint. Defaults to &quot;&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="c1"># Merge equation with constraint</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ee</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;ge&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">ee</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">,</span> <span class="n">name</span>
            <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;le&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">ee</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">,</span> <span class="n">name</span>
            <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;eq&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">ee</span> <span class="o">==</span> <span class="n">c</span><span class="p">,</span> <span class="n">name</span>


    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;ge&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">eq</span> <span class="o">&gt;=</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">name</span>
        <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;le&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">eq</span> <span class="o">&lt;=</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">name</span>
        <span class="k">elif</span> <span class="n">way</span> <span class="o">==</span> <span class="s2">&quot;eq&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">+=</span> <span class="n">eq</span> <span class="o">==</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.add_objective" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_objective</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the objective function of the problem as a linear expression</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>eq</code></td>
          <td>
                <code>mip.<span title="mip.LinExpr">LinExpr</span></code>
          </td>
          <td><p>equation defining the objective function</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eq</span><span class="p">:</span><span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the objective function of the problem as a linear expression</span>

<span class="sd">    Args:</span>
<span class="sd">        eq (mip.LinExpr): equation defining the objective function</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="n">eq</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.base_model_create" class="doc doc-heading">
<code class="highlight language-python"><span class="n">base_model_create</span><span class="p">(</span><span class="n">intervention</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">all_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">all_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">space_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A function   </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>intervention</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with set of interventions</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>space</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with information on regions/locations</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with information on time/years</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>all_time</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list of intervention vehicles that are active during all periods (e.g., cube, oil). Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>all_space</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list of intervention vehicles that are targeted at a country-wide level (e.g., cube, oil). Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>time_subset</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list with subset of periods. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>space_subset</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list with subset of regions/locations. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>strict</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains). Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">base_model_create</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">intervention</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
    <span class="n">space</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span>
    <span class="n">all_time</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">all_space</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">time_subset</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">space_subset</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">strict</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A function   </span>

<span class="sd">    Args:</span>
<span class="sd">        intervention (str): name of dataframe&#39;s column with set of interventions</span>
<span class="sd">        space (str): name of dataframe&#39;s column with information on regions/locations</span>
<span class="sd">        time (str): name of dataframe&#39;s column with information on time/years</span>
<span class="sd">        all_time (list, optional): list of intervention vehicles that are active during all periods (e.g., cube, oil). Defaults to None.</span>
<span class="sd">        all_space (list, optional): list of intervention vehicles that are targeted at a country-wide level (e.g., cube, oil). Defaults to None.</span>
<span class="sd">        time_subset (list, optional): list with subset of periods. Defaults to None.</span>
<span class="sd">        space_subset (list, optional):list with subset of regions/locations. Defaults to None.</span>
<span class="sd">        strict (bool, optional): whether to look for specific intervention names (using DataFrame.isin) or whether to look for a regex (using DataFrame.str.contains). Defaults to False.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Now we create the choice variable, x, which is binary and is the size of the dataset.</span>
    <span class="c1">## In this case, it should just be a column vector with the rows equal to the data:</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_model_var_create</span><span class="p">()</span>

    <span class="c1">## First add base constraint, which only allows one intervention per time and space</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_base_constraint</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>

    <span class="c1">## Add all_space or all_time constraints if necessary</span>
    <span class="k">if</span> <span class="n">all_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;One of the subset columns were not found&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_all_time_constraint</span><span class="p">(</span>
            <span class="n">strict</span><span class="p">,</span>
            <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">subset_names</span><span class="o">=</span><span class="n">all_time</span><span class="p">,</span>
            <span class="n">over</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">subset_list</span><span class="o">=</span><span class="n">time_subset</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">all_space</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;One of the subset columns were not found&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_all_space_constraint</span><span class="p">(</span>
            <span class="n">strict</span><span class="p">,</span>
            <span class="n">intervention</span><span class="o">=</span><span class="n">intervention</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">subset_names</span><span class="o">=</span><span class="n">all_space</span><span class="p">,</span>
            <span class="n">over</span><span class="o">=</span><span class="n">space</span><span class="p">,</span>
            <span class="n">subset_list</span><span class="o">=</span><span class="n">space_subset</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.get_equation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_equation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function returns a constraint by its name. If no name is specified, returns all constraints</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a string corresponding to the name of the constraint. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>show</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to return the contraint in string type or not. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>str or mip.LinExpr or mip.Constr: A <code>mip</code> constraint object</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_equation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span> <span class="ow">or</span> <span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span> <span class="ow">or</span> <span class="n">mip</span><span class="o">.</span><span class="n">Constr</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function returns a constraint by its name. If no name is specified, returns all constraints</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str, optional): a string corresponding to the name of the constraint. Defaults to None.</span>
<span class="sd">        show (bool, optional): whether to return the contraint in string type or not. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str or mip.LinExpr or mip.Constr: A `mip` constraint object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">constrs</span>
    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;objective&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">constr_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">constr_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.get_model_results" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_model_results</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function returns a list with additional results of the optimization procedure</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>model's results</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_model_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function returns a list with additional results of the optimization procedure</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: model&#39;s results</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective_value</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective_values</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective_bound</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_solutions</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_cols</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_int</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_nz</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.optimize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">optimize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function conducts the optimization procedure </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td><p>Other parameters for optimization procedure using `mip.optimize' (max_seconds, max_nodes, max_solutions)</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function conducts the optimization procedure </span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: Other parameters for optimization procedure using `mip.optimize&#39; (max_seconds, max_nodes, max_solutions)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_cols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NoVars</span><span class="p">(</span><span class="s2">&quot;No Variables added to the model&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NoConstraints</span><span class="p">(</span><span class="s2">&quot;No constraints added to the model.&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">objective</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NoObjective</span><span class="p">(</span><span class="s2">&quot;No Objective added to the model&quot;</span><span class="p">)</span>

    <span class="c1"># Now, allow for arguments to the optimize function to be given:</span>

    <span class="n">max_seconds</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_seconds&quot;</span><span class="p">,</span> <span class="n">mip</span><span class="o">.</span><span class="n">INF</span><span class="p">)</span>
    <span class="n">max_nodes</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_nodes&quot;</span><span class="p">,</span> <span class="n">mip</span><span class="o">.</span><span class="n">INF</span><span class="p">)</span>
    <span class="n">max_solutions</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;max_solutions&quot;</span><span class="p">,</span> <span class="n">mip</span><span class="o">.</span><span class="n">INF</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">max_seconds</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_solutions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">suppress_stdout_stderr</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">max_seconds</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_solutions</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Optimal Solution Found&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">FEASIBLE</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Feasible Solution Found. This may not be optimal.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">NO_SOLUTION_FOUND</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Warning]: No Solution Found&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">mip</span><span class="o">.</span><span class="n">OptimizationStatus</span><span class="o">.</span><span class="n">INFEASIBLE</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Warning]: Infeasible Solution Found&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.process_results" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process_results</span><span class="p">(</span><span class="n">benefit_col</span><span class="p">,</span> <span class="n">cost_col</span><span class="p">,</span> <span class="n">intervention_col</span><span class="p">,</span> <span class="n">space_col</span><span class="p">,</span> <span class="n">sol_num</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function creates a dataframe with information on benefits and costs for the optimal interventions</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>benefit_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with benefits</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cost_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with costs</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>intervention_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with set of interventions</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>space_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with information on regions/locations</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sol_num</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>index of solution. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pd.DataFrame: dataframe with optimal interventions</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">benefit_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">cost_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">intervention_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">space_col</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">sol_num</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function creates a dataframe with information on benefits and costs for the optimal interventions</span>

<span class="sd">    Args:</span>
<span class="sd">        benefit_col (str): name of dataframe&#39;s column with benefits</span>
<span class="sd">        cost_col (str): name of dataframe&#39;s column with costs</span>
<span class="sd">        intervention_col (str): name of dataframe&#39;s column with set of interventions</span>
<span class="sd">        space_col (str): name of dataframe&#39;s column with information on regions/locations</span>
<span class="sd">        sol_num (int, optional): index of solution. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: dataframe with optimal interventions</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol_num</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">opt_vals</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="n">sol_num</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">opt_vals</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mip_vars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

    <span class="n">opt_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">opt_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">opt_benefit</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">benefit_col</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">],</span>
        <span class="n">opt_costs</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">cost_col</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">],</span>
        <span class="n">opt_costs_discounted</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;discounted_costs&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">],</span>
        <span class="n">opt_benefit_discounted</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;discounted_benefits&quot;</span><span class="p">]</span><span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;opt_vals&quot;</span><span class="p">])</span>
              <span class="o">.</span><span class="n">infer_objects</span><span class="p">()</span>
              <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">cumulative_discounted_benefits</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                     <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_benefit_discounted&#39;</span><span class="p">]</span>
                                                     <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)),</span>
        <span class="n">cumulative_discounted_costs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                     <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_costs_discounted&#39;</span><span class="p">]</span>
                                                     <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)),</span>
        <span class="n">cumulative_benefits</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                     <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_benefit&#39;</span><span class="p">]</span>
                                                     <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)),</span>
        <span class="n">cumulative_costs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                     <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">space_col</span><span class="p">])[</span><span class="s1">&#39;opt_costs&#39;</span><span class="p">]</span>
                                                     <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">))</span>
    <span class="p">)[</span>
        <span class="p">[</span>
            <span class="s2">&quot;opt_vals&quot;</span><span class="p">,</span>
            <span class="s2">&quot;opt_benefit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;opt_costs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;opt_costs_discounted&quot;</span><span class="p">,</span>
            <span class="s2">&quot;opt_benefit_discounted&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cumulative_discounted_benefits&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cumulative_discounted_costs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cumulative_benefits&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cumulative_costs&quot;</span>
            <span class="p">]</span>
    <span class="p">])</span>


    <span class="k">return</span> <span class="n">opt_df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.model.Model.write" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;model.lp&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Thi function saves model to file</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of file. Defaults to "model.lp".</p></td>
          <td>
                <code>&#39;model.lp&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/model.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;model.lp&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Thi function saves model to file</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str, optional): name of file. Defaults to &quot;model.lp&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="minimod_opt.base.basesolver"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="minimod_opt.base.basesolver.BaseSolver" class="doc doc-heading">
        <code>BaseSolver</code>


</h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BaseSolver</span><span class="p">:</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">benefit_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;benefits&#39;</span><span class="p">,</span>
        <span class="n">cost_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;costs&#39;</span><span class="p">,</span>
        <span class="n">intervention_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;intervention&#39;</span><span class="p">,</span>
        <span class="n">space_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;space&#39;</span><span class="p">,</span>
        <span class="n">time_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
        <span class="n">interest_rate_cost</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Discount factor for costs</span>
        <span class="n">interest_rate_benefit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>  <span class="c1"># Discount factor for benefits </span>
        <span class="n">va_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># VA Weight</span>
        <span class="n">sense</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># MIP optimization type (maximization or minimization)</span>
        <span class="n">solver_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">mip</span><span class="o">.</span><span class="n">CBC</span><span class="p">,</span>  <span class="c1"># Solver for MIP to use</span>
        <span class="n">show_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">benefit_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Benefits&quot;</span><span class="p">,</span>
    <span class="p">):</span>       

<span class="w">        </span><span class="sd">&quot;&quot;&quot;The base solver for the Optimization. This sets up the basic setup of the model, which includes:</span>
<span class="sd">        - data handling</span>
<span class="sd">        - BAU constraint creation</span>
<span class="sd">        - base model constraint creation</span>

<span class="sd">        Args:</span>
<span class="sd">                data (pd.DataFrame): dataframe with benefits and cost data.</span>
<span class="sd">                benefit_col (str, optional): name of dataframe&#39;s column with benefit data. Defaults to &#39;benefits&#39;.</span>
<span class="sd">                cost_col (str, optional): name of dataframe&#39;s column with cost data. Defaults to &#39;costs&#39;.</span>
<span class="sd">                intervention_col (str, optional): name of dataframe&#39;s column with intervention data. Defaults to &#39;intervention&#39;.</span>
<span class="sd">                space_col (str, optional): name of dataframe&#39;s column with space/region data . Defaults to &#39;space&#39;.</span>
<span class="sd">                time_col (str, optional): name of dataframe&#39;s column with time period data . Defaults to &#39;time&#39;.</span>
<span class="sd">                interest_rate_cost (float, optional): interest rate of costs. Defaults to 0.0.</span>
<span class="sd">                benefit_title (str, optional): title for benefits to use in plots and reports. Defaults to &quot;Benefits&quot;.</span>

<span class="sd">        ``BaseSolver`` is inherited by ``CostSolver`` and ``BenefitSolver`` to then run optimizations.</span>
<span class="sd">        &quot;&quot;&quot;</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_cost</span> <span class="o">=</span> <span class="n">interest_rate_cost</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_benefit</span> <span class="o">=</span> <span class="n">interest_rate_benefit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">va_weight</span> <span class="o">=</span> <span class="n">va_weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discount_costs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_cost</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discount_benefits</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_benefit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span> <span class="o">=</span> <span class="n">benefit_title</span>

        <span class="k">if</span> <span class="n">sense</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sense</span> <span class="o">=</span> <span class="n">sense</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No Optimization Method was specified&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">solver_name</span> <span class="o">=</span> <span class="n">solver_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span> <span class="o">=</span> <span class="n">show_output</span>

        <span class="c1"># Process Data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Processing Data...&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_data</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">intervention</span><span class="o">=</span><span class="n">intervention_col</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="n">space_col</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time_col</span><span class="p">,</span>
            <span class="n">benefits</span><span class="o">=</span><span class="n">benefit_col</span><span class="p">,</span>
            <span class="n">costs</span><span class="o">=</span><span class="n">cost_col</span><span class="p">,</span>
        <span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span> <span class="o">=</span> <span class="n">benefit_col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span> <span class="o">=</span> <span class="n">cost_col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span> <span class="o">=</span> <span class="n">intervention_col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span> <span class="o">=</span> <span class="n">space_col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_col</span> <span class="o">=</span> <span class="n">time_col</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Creating Base Model with constraints&quot;</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_benefit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_funds</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                MiniMod Nutrition Intervention Tool</span>
<span class="s2">                Optimization Method: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sense</span><span class="p">)</span><span class="si">}</span>
<span class="s2">                Solver: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_name</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">                Show Output: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="si">}</span>

<span class="s2">                &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">_discounted_sum_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mip</span><span class="o">.</span><span class="n">LinExpr</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Multiply each ``mip_var`` in the data by benefits or costs (``data``) and then create a ``mip`` expression from it.</span>

<span class="sd">        Args:</span>
<span class="sd">            col_name (str): name of dataframe&#39;s column with benefits or costs data</span>

<span class="sd">        Returns:</span>
<span class="sd">            mip.LinExpr: ``mip`` Expression</span>
<span class="sd">        &quot;&quot;&quot;</span>    

        <span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="s1">&#39;mip_vars&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col_name</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mip</span><span class="o">.</span><span class="n">xsum</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">eq</span>

    <span class="k">def</span> <span class="nf">_discounted_sum_over</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">over</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Abstract function used for constructing the objective function and main constraint of the model</span>

<span class="sd">        Args:</span>
<span class="sd">            col_name (str): name of dataframe&#39;s column with benefits or costs data</span>
<span class="sd">            over (str): name of dataframe&#39;s column with attribute used to group data by (e.g. time)</span>

<span class="sd">        Returns:</span>
<span class="sd">            (pd.Dataframe): pd.Dataframe with mip variables as observations</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Merge data with self._df   </span>
        <span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="s1">&#39;mip_vars&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_df</span><span class="p">[</span><span class="n">col_name</span><span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">over</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mip</span><span class="o">.</span><span class="n">xsum</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">eq</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span> <span class="p">:</span> <span class="n">col_name</span> <span class="o">+</span> <span class="s1">&#39;_vars&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_is_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if input dataset is a ``pandas.DataFrame``</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Any): input data</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotPandasDataframe: Exception if not a ``pandas.DataFrame``</span>
<span class="sd">        &quot;&quot;&quot;</span>    

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">NotPandasDataframe</span><span class="p">(</span>
                <span class="s2">&quot;[Error]: Input data is not a dataframe. Please input a dataframe.&quot;</span>
            <span class="p">)</span>


    <span class="k">def</span> <span class="nf">_process_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span><span class="s2">&quot;intervention&quot;</span><span class="p">,</span>
        <span class="n">space</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;space&quot;</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
        <span class="n">benefits</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;benefits&quot;</span><span class="p">,</span>
        <span class="n">costs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;costs&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="p">:</span>      
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Processes the input data by creating discounted benefits and costs.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.DataFrame, optional): raw data to be processed. Defaults to None.</span>
<span class="sd">            intervention (str, optional): name of dataframe&#39;s column with intervention data. Defaults to &quot;intervention&quot;.</span>
<span class="sd">            space (str, optional): name of dataframe&#39;s column with space/region data. Defaults to &quot;space&quot;.</span>
<span class="sd">            time (str, optional): name of dataframe&#39;s column with time period data. Defaults to &quot;time&quot;.</span>
<span class="sd">            benefits (str, optional): name of dataframe&#39;s column with benefits data. Defaults to &quot;benefits&quot;.</span>
<span class="sd">            costs (str, optional): name of dataframe&#39;s column with cost data. Defaults to &quot;costs&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (pd.DataFrame): dataframe ready to be used in the problem</span>


<span class="sd">        |k     | j   |t   | benefits   | costs |</span>
<span class="sd">        |------|-----|----|------------|-------|</span>
<span class="sd">        |maize |north|0   | 100        | 10    |</span>
<span class="sd">        |maize |south|0   | 50         | 20    |</span>
<span class="sd">        |maize |east |0   | 30         |30     |</span>
<span class="sd">        |maize |west |0   | 20         |40     |</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">## First do some sanity checks</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MissingData</span><span class="p">(</span><span class="s2">&quot;No data specified.&quot;</span><span class="p">)</span>

        <span class="c1"># Check if dataframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">df_aux</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
                <span class="n">time_col</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
                <span class="n">time_rank</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
                <span class="n">time_discount_costs</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">discount_costs</span> <span class="o">**</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time_rank&quot;</span><span class="p">],</span>
                <span class="n">time_discount_benefits</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">discount_benefits</span>
                <span class="o">**</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time_rank&quot;</span><span class="p">],</span>
                <span class="n">discounted_costs</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time_discount_costs&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="n">costs</span><span class="p">],</span>
                <span class="n">discounted_benefits</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time_discount_benefits&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">benefits</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">df_aux</span><span class="p">[</span><span class="n">intervention</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_aux</span><span class="p">[</span><span class="n">intervention</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">df_aux</span>
            <span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">intervention</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">])</span>
            <span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="p">(</span><span class="n">intervention</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">time</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function defines the constraints for the mips model.</span>
<span class="sd">        To be overridden by BenefitSolver and CostSolver classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraint_called</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function defines the objective function for a model.</span>
<span class="sd">        To be overridden by BenefitSolver and CostSolver classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>


    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fits data to model. The instantiation of the class creates the base model. Uses ``mip.optimize`` to find the optimal point.</span>

<span class="sd">        Args:</span>
<span class="sd">            *kwargs: Other parameters to send to mip.optimize</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: return self</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Optimizing...&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  

        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_value</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">objective_values</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">objective_bound</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">num_solutions</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">num_cols</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">num_int</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">num_nz</span><span class="p">,</span> 
         <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_model_results</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;model.lp&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save model to file</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str, optional):name of the file. Defaults to &quot;model.lp&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_num</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Processes results of optimization to be used in visualization and reporting functions</span>

<span class="sd">        Args:</span>
<span class="sd">            sol_num (int, optional): index of solution. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">process_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                                            <span class="n">sol_num</span><span class="o">=</span><span class="n">sol_num</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_num</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints out a report of optimal model parameters and useful statistics.</span>

<span class="sd">        Args:</span>
<span class="sd">            sol_num (int, optional): index of solution to be displayed. Defaults to None.</span>
<span class="sd">            quiet (bool, optional): whether we want the report printed out or not. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">process_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                                            <span class="n">sol_num</span><span class="o">=</span><span class="n">sol_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;MiniMod Solver Results&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Method:&quot;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sense</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;Solver:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_name</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;Optimization Status:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;Number of Solutions Found:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_solutions</span><span class="p">))</span>

        <span class="p">]</span>

        <span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;No. of Variables:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cols</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;No. of Integer Variables:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_int</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;No. of Constraints&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;No. of Non-zeros in Constr.&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_nz</span><span class="p">))</span>
        <span class="p">]</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">OptimizationSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">s</span><span class="o">.</span><span class="n">print_generic</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Interventions Chosen:&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">optimal_interventions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">opt_intervention</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span>
            <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_vals&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
            <span class="o">.</span><span class="n">index</span>
            <span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Outputs the unique set of optimal interventions as a list</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: The list of optimal interventions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">opt_intervention</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_intervention_list_space_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a data frame with multindex (space_col, time_col) where each row is the optimal intervention.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: A dataframe where each row is the optimal intervention for each time period and space</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">[</span><span class="s1">&#39;opt_vals&#39;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">)</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">int_appeared</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_vals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
            <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_col</span><span class="p">])</span>
            <span class="p">[</span><span class="s1">&#39;int_appeared&#39;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
            <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bau_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a dataframe with the name of the bau intervention. Mostly done for compatibility with other methods.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: dataframe with the name of the bau intervention</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span> <span class="p">:</span> <span class="s1">&#39;int_appeared&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">[</span><span class="s1">&#39;int_appeared&#39;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>


    <span class="k">def</span> <span class="nf">plot_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                  <span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                  <span class="n">ax</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">cumulative_discount</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots optimal benefits and costs across time after model optimization</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (matplotlib.figure, optional): matplotlib figure. Defaults to None.</span>
<span class="sd">            ax (matplotlib.axis, optional): matplotlib axis to use. Defaults to None.</span>
<span class="sd">            save (str, optional): path to save the figure. Defaults to None.</span>
<span class="sd">            cumulative (bool, optional): whether to plot cumulative benefits or costs. Defaults to False.</span>
<span class="sd">            cumulative_discount (bool, optional): whether to plot cumulative benefits or costs, discounted. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            matplotlib.figure: figure with optimal benefits and cost across time</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cumulative_benefits&#39;</span><span class="p">,</span> <span class="s1">&#39;cumulative_costs&#39;</span><span class="p">],</span>
                    <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Optima over Time&quot;</span><span class="p">,</span>
                    <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                    <span class="n">twin</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">twin_ylabel</span><span class="o">=</span> <span class="s2">&quot;Currency&quot;</span><span class="p">,</span>
                    <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">,</span>
                    <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cumm. &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                            <span class="s1">&#39;Cumm. Costs&#39;</span><span class="p">],</span>
                    <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cumulative_discount</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cumulative_discounted_benefits&#39;</span><span class="p">,</span> <span class="s1">&#39;cumulative_discounted_costs&#39;</span><span class="p">],</span>
                    <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Optima over Time&quot;</span><span class="p">,</span>
                    <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                    <span class="n">twin</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">twin_ylabel</span><span class="o">=</span> <span class="s2">&quot;Currency&quot;</span><span class="p">,</span>
                    <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">,</span>
                    <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cumm. Dis. &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                            <span class="s1">&#39;Cumm. Dis. Costs&#39;</span><span class="p">],</span>
                    <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;opt_benefit&#39;</span><span class="p">,</span> <span class="s1">&#39;opt_costs&#39;</span><span class="p">],</span>
                                <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Optima over Time&quot;</span><span class="p">,</span>
                                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                                <span class="n">twin</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">twin_ylabel</span><span class="o">=</span> <span class="s2">&quot;Currency&quot;</span><span class="p">,</span>
                                <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">,</span>
                                <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Optimal &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                                        <span class="s1">&#39;Optimal Costs&#39;</span><span class="p">],</span>
                                <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                                <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_bau_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">opt_variable</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                      <span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">ax</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots benefits and costs of optimal and benchark interventions across time </span>

<span class="sd">        Args:</span>
<span class="sd">            opt_variable (str, optional): optimal variable to be plotted, where</span>
<span class="sd">                b = optimal benefits</span>
<span class="sd">                c = &#39;optimal costs</span>
<span class="sd">                cdb = cumulative discounted benefits</span>
<span class="sd">                cdc = cumulative discounted costs</span>
<span class="sd">                cb = cumulative benefits</span>
<span class="sd">                cc = cumulative costs</span>
<span class="sd">            Defaults to &#39;b&#39;.</span>
<span class="sd">            fig (matplotlib.figure, optional): matplotlib figure. Defaults to None.</span>
<span class="sd">            ax (matplotlib.axis, optional):matplotlib axis to use. Defaults to None.</span>
<span class="sd">            save (str, optional): path to save the figure. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: not one of the allowed variables for map plotting</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
            <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span> <span class="o">+</span> <span class="s2">&quot; vs. BAU&quot;</span>
        <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>
            <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Costs vs. BAU&quot;</span>
        <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cdb&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_benefits&#39;</span>
            <span class="n">bau_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_benefits&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
        <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cdc&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_costs&#39;</span>
            <span class="n">bau_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_costs&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted Costs&#39;</span>
        <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_benefits&#39;</span>
            <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>      
        <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cc&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_costs&#39;</span>
            <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Costs&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not one of the allowed variables for map plotting. Try again.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">opt_variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cdb&#39;</span><span class="p">,</span> <span class="s1">&#39;cdc&#39;</span><span class="p">,</span> <span class="s1">&#39;cb&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">]:</span>

            <span class="n">bench_df</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span>
                <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">time_col</span><span class="p">])</span>
                <span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">bau_col</span><span class="p">])</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">bench_df</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span>
                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">bau_col</span><span class="p">])</span>
                <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">time_col</span><span class="p">])</span>
                <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                        <span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span> <span class="n">title</span><span class="p">,</span>
                    <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                    <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">bench_df</span><span class="p">[</span><span class="s1">&#39;bench_col&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Optimal&#39;</span><span class="p">,</span> <span class="s1">&#39;BAU&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">plot_opt_val_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                          <span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                          <span class="n">ax</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                          <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A histogram of the optimally chosen interventions</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (matplotlib.figure, optional): figure instance to use. Defaults to None.</span>
<span class="sd">            ax (matplotlib.axis, optional): axis instance to use. Defaults to None.</span>
<span class="sd">            save (str, optional): path to save the figure. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            matplotlib.figure: histogram figure</span>
<span class="sd">        &quot;&quot;&quot;</span>      

        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="s1">&#39;opt_vals&#39;</span><span class="p">,</span>
                            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Choices&quot;</span><span class="p">,</span>
                            <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span>
                            <span class="n">ylabel</span><span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span>
                            <span class="n">axis</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
                            <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">)</span>  

    <span class="k">def</span> <span class="nf">plot_chloropleth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">optimum_interest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                         <span class="n">map_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span>  <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">merge_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">intervention_bubbles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">intervention_bubble_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a chloropleth map of the specified intervention and time period for the optimal variable. </span>
<span class="sd">        If more than one intervention is specified, then aggregates them. If more than one time period is specified, then creates a subplots of len(time) and show each.</span>

<span class="sd">        Args:</span>
<span class="sd">            intervention (str, optional): intervention to use. Defaults to None.</span>
<span class="sd">            time (Union[int,list], optional): time periods to plot. Defaults to None.</span>
<span class="sd">            optimum_interest (str, optional): optimal variable to use (Options include: &#39;b&#39; for optimal benefits, &#39;c&#39; for optimal costs, and &#39;v&#39; for optimal variable). Defaults to &#39;b&#39;.</span>
<span class="sd">            map_df (geopandas.GeoDataFrame, optional): geopandas dataframe with geometry information. Defaults to None.</span>
<span class="sd">            merge_key (Union[str,list], optional): column to merge geo-dataframe. Defaults to None.</span>
<span class="sd">            intervention_bubbles (bool, optional): whether to show optimal intervention names in map. Defaults to False.</span>
<span class="sd">            intervention_bubble_names (Union[str,list], optional): key to merge on to geo dataframe. Defaults to None.</span>
<span class="sd">            save (str, optional): path to save map. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: Not one of the allowed variables for map plotting</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_interventions</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Costs&quot;</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_vals&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Interventions&quot;</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdb&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_benefits&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdc&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_costs&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted Costs&#39;</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_benefits&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>      
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cc&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_costs&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Costs&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not one of the allowed variables for map plotting. Try again.&quot;</span><span class="p">)</span>


        <span class="n">plotter</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_chloropleth_getter</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">)</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">,</span>
                                          <span class="n">intervention</span> <span class="o">=</span> <span class="n">intervention</span><span class="p">,</span>
                                            <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                            <span class="n">optimum_interest</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span>
                                            <span class="n">map_df</span> <span class="o">=</span> <span class="n">map_df</span><span class="p">,</span>
                                            <span class="n">merge_key</span><span class="o">=</span><span class="n">merge_key</span><span class="p">,</span>
                                            <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                                            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">,</span>
                                            <span class="n">intervention_bubbles</span> <span class="o">=</span> <span class="n">intervention_bubbles</span><span class="p">,</span>
                                            <span class="n">intervention_bubble_names</span> <span class="o">=</span> <span class="n">intervention_bubble_names</span><span class="p">,</span>
                                            <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">)</span>
        <span class="c1"># return plot</span>


    <span class="k">def</span> <span class="nf">plot_grouped_interventions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                                    <span class="n">data_of_interest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;benefits&#39;</span><span class="p">,</span> 
                                    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                    <span class="n">intervention_subset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
                                    <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shows Optimal level of benefits or costs in a grouped bar plots for every optimally chosen variable across regions.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_of_interest (str, optional): variable to show. Defaults to &#39;benefits&#39;.</span>
<span class="sd">            title (str, optional):title for resulting plot. Defaults to None.</span>
<span class="sd">            intervention_subset (Union[str,list], optional): subset of interventions to show on bar plot. Defaults to slice(None).</span>
<span class="sd">            save (str, optional): path to save the figure. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">data_of_interest</span> <span class="o">==</span> <span class="s1">&#39;benefits&#39;</span><span class="p">:</span>
            <span class="n">col_of_interest</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
        <span class="k">elif</span> <span class="n">data_of_interest</span> <span class="o">==</span> <span class="s1">&#39;costs&#39;</span><span class="p">:</span>
            <span class="n">col_of_interest</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>

        <span class="n">p</span><span class="o">.</span><span class="n">_plot_grouped_bar</span><span class="p">(</span><span class="n">intervention_col</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                            <span class="n">space_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                            <span class="n">col_of_interest</span><span class="o">=</span> <span class="n">col_of_interest</span><span class="p">,</span>
                            <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Optimal Level&quot;</span><span class="p">,</span>
                            <span class="n">intervention_subset</span><span class="o">=</span> <span class="n">intervention_subset</span><span class="p">,</span>
                            <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">plot_map_benchmark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                           <span class="n">intervention</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">time</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">optimum_interest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                           <span class="n">bench_intervention</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">map_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">merge_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">intervention_in_title</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="n">intervention_bubbles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">intervention_bubble_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">millions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="n">bau_intervention_bubble_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                           <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maps the optimal level on a map against a benchmark, optionally the BAU level chosen from ``minimum_benefit`` or ``total_funds``.</span>

<span class="sd">        Args:</span>
<span class="sd">            intervention (list, optional): interventions to map. Defaults to None.</span>
<span class="sd">            time (list, optional): time periods to map. Defaults to None.</span>
<span class="sd">            optimum_interest (str, optional):  optimal value to use. Options include &#39;b&#39; (benefits), &#39;c&#39; (costs), &#39;v&#39; (variables). Defaults to &#39;b&#39;.</span>
<span class="sd">            bench_intervention (list, optional): interventions to use for benchmark. Defaults to None.</span>
<span class="sd">            map_df (geopandas.GeoDataFrame, optional):  geo dataframe with geometry data. Defaults to None.</span>
<span class="sd">            merge_key (Union[str,list], optional): key to merge data from opt_df to geo dataframe. Defaults to None.</span>
<span class="sd">            save (str, optional): path to save the map. Defaults to None.</span>
<span class="sd">            intervention_in_title (bool, optional): True if intervention name will be included in the title of the figure. Defaults to True.</span>
<span class="sd">            intervention_bubbles (bool, optional): True if intervention bubbles. Defaults to False.</span>
<span class="sd">            intervention_bubble_names (Union[str,list], optional): names of intervention bubbles. Defaults to None.</span>
<span class="sd">            millions (bool, optional): True if values displayed in millions. Defaults to True.</span>
<span class="sd">            bau_intervention_bubble_names (Union[str,list], optional): name for bau intervention bubble. Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_interventions</span>   

        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>   
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

        <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">optimal</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">bench</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
            <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>
            <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Costs&quot;</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_vals&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Interventions&quot;</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdb&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_discounted_benefits&#39;</span>
            <span class="n">bench_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_benefits&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdc&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_discounted_costs&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted Costs&#39;</span>
            <span class="n">bench_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_costs&#39;</span>
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_benefits&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>   
            <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>   
        <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cc&#39;</span><span class="p">:</span>
            <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_costs&#39;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Costs&#39;</span>
            <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not one of the allowed variables for map plotting. Try again.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bench_intervention</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bench_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_benefit</span>

        <span class="k">if</span> <span class="n">merge_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">merge_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span>

        <span class="k">if</span> <span class="n">optimum_interest</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cdb&#39;</span><span class="p">,</span> <span class="s1">&#39;cdc&#39;</span><span class="p">,</span> <span class="s1">&#39;cb&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">]:</span>

            <span class="n">bench_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                            <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span> 
                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">])</span>
                                                            <span class="p">[</span><span class="n">bench_col</span><span class="p">]</span>
                                                            <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">bench_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">bench_col</span><span class="p">])</span>

        <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span>

        <span class="k">if</span> <span class="n">intervention_in_title</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Optimal Interventions:</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">intervention</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">.05</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_chloropleth_getter</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

        <span class="c1"># Get min and max values for color map</span>
        <span class="n">opt_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">opt_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="n">bench_max</span> <span class="o">=</span> <span class="n">bench_df</span><span class="p">[</span><span class="s1">&#39;bench_col&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">bench_min</span> <span class="o">=</span> <span class="n">bench_df</span><span class="p">[</span><span class="s1">&#39;bench_col&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">opt_max</span><span class="p">,</span> <span class="n">bench_max</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">opt_min</span><span class="p">,</span> <span class="n">bench_min</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">intervention_bubbles</span><span class="p">:</span>
            <span class="n">bau_intervention_bubbles</span> <span class="o">=</span> <span class="s1">&#39;bau&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bau_intervention_bubbles</span> <span class="o">=</span> <span class="kc">False</span>


        <span class="n">plotter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">,</span>
                    <span class="n">intervention</span> <span class="o">=</span> <span class="n">intervention</span><span class="p">,</span>
                    <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                    <span class="n">optimum_interest</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span>
                    <span class="n">map_df</span> <span class="o">=</span> <span class="n">map_df</span><span class="p">,</span>
                    <span class="n">merge_key</span><span class="o">=</span><span class="n">merge_key</span><span class="p">,</span>
                    <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">optimal</span><span class="p">,</span>
                    <span class="n">cax</span> <span class="o">=</span> <span class="n">cbar</span><span class="p">,</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Scenario&quot;</span><span class="p">,</span>
                    <span class="n">intervention_bubbles</span> <span class="o">=</span> <span class="n">intervention_bubbles</span><span class="p">,</span>
                    <span class="n">intervention_bubble_names</span> <span class="o">=</span> <span class="n">intervention_bubble_names</span><span class="p">,</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span>
                    <span class="n">legend_kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;orientation&#39;</span> <span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">})</span>

        <span class="n">plotter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">bench_df</span><span class="p">,</span>
                        <span class="n">intervention</span> <span class="o">=</span> <span class="n">bench_intervention</span><span class="p">,</span>
                        <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                        <span class="n">optimum_interest</span><span class="o">=</span> <span class="s1">&#39;bench_col&#39;</span><span class="p">,</span>
                        <span class="n">map_df</span> <span class="o">=</span> <span class="n">map_df</span><span class="p">,</span>
                        <span class="n">merge_key</span><span class="o">=</span><span class="n">merge_key</span><span class="p">,</span>
                        <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="n">ax</span> <span class="o">=</span> <span class="n">bench</span><span class="p">,</span>
                        <span class="n">show_legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;BAU* Scenario&quot;</span><span class="p">,</span>
                         <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span>
                        <span class="n">intervention_bubbles</span> <span class="o">=</span> <span class="n">bau_intervention_bubbles</span><span class="p">,</span>
                        <span class="n">intervention_bubble_names</span> <span class="o">=</span> <span class="n">bau_intervention_bubble_names</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">fig_text</span> <span class="o">=</span> <span class="s1">&#39;Note: Colors describe &#39;</span> <span class="o">+</span> <span class="n">title</span>

        <span class="k">if</span> <span class="n">millions</span><span class="p">:</span>
            <span class="n">fig_text</span> <span class="o">=</span> <span class="n">fig_text</span> <span class="o">+</span> <span class="s1">&#39; (in millions)&#39;</span>

        <span class="c1"># if intervention_bubble_names:</span>
        <span class="c1">#     fig_text = fig_text + &#39;\nBAU* scenario made up of &#39; + &#39;, &#39;.join(intervention_bubble_names)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">.05</span><span class="p">,</span> <span class="n">fig_text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>  
    <span class="k">def</span> <span class="nf">supply_curve</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> 
                    <span class="n">full_population</span><span class="p">,</span>
                    <span class="n">bau</span><span class="p">,</span>
                    <span class="n">all_space</span><span class="p">,</span>
                    <span class="n">all_time</span><span class="p">,</span>
                    <span class="n">time_subset</span><span class="p">,</span>
                    <span class="n">benefit_col</span><span class="o">=</span><span class="s1">&#39;effective_coverage&#39;</span><span class="p">,</span>
                    <span class="n">cost_col</span><span class="o">=</span><span class="s1">&#39;cost&#39;</span><span class="p">,</span>
                    <span class="n">intervention_col</span><span class="o">=</span><span class="s1">&#39;intervention&#39;</span><span class="p">,</span>
                    <span class="n">space_col</span><span class="o">=</span><span class="s1">&#39;space&#39;</span><span class="p">,</span>
                    <span class="n">time_col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
                    <span class="n">ec_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">above_ul</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">above_ul_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> 

        <span class="k">if</span> <span class="n">ec_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ec_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">.1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">above_ul</span> <span class="ow">and</span> <span class="n">above_ul_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">above_ul_col</span> <span class="o">=</span> <span class="s1">&#39;above_ul&#39;</span>


        <span class="n">ratio_to_constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ratio</span><span class="p">:</span> <span class="n">ratio</span><span class="o">*</span><span class="n">full_population</span>

        <span class="n">model_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">benefit_constraint</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">bau</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">ec_range</span><span class="p">)):</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">benefit_constraint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">minimum_benefit</span> <span class="o">=</span> <span class="n">benefit_constraint</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minimum_benefit</span> <span class="o">=</span> <span class="n">ratio_to_constraint</span><span class="p">(</span><span class="n">benefit_constraint</span><span class="p">)</span>

            <span class="n">c</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">minimum_benefit</span> <span class="o">=</span> <span class="n">minimum_benefit</span><span class="p">,</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> 
                        <span class="n">benefit_col</span> <span class="o">=</span> <span class="n">benefit_col</span><span class="p">,</span>
                        <span class="n">cost_col</span> <span class="o">=</span> <span class="n">cost_col</span><span class="p">,</span>
                        <span class="n">intervention_col</span> <span class="o">=</span> <span class="n">intervention_col</span><span class="p">,</span>
                        <span class="n">space_col</span> <span class="o">=</span> <span class="n">space_col</span><span class="p">,</span>
                        <span class="n">time_col</span> <span class="o">=</span> <span class="n">time_col</span><span class="p">,</span>
                        <span class="n">all_space</span> <span class="o">=</span><span class="n">all_space</span><span class="p">,</span> 
                        <span class="n">all_time</span> <span class="o">=</span> <span class="n">all_time</span><span class="p">,</span>
                        <span class="n">time_subset</span> <span class="o">=</span> <span class="n">time_subset</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">opt</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

            <span class="n">model_dict</span><span class="p">[</span><span class="n">benefit_constraint</span><span class="p">]</span> <span class="o">=</span> <span class="n">opt</span>

        <span class="n">results_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;benefit&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                        <span class="s1">&#39;opt_benefits&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                        <span class="s1">&#39;opt_costs&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                        <span class="s1">&#39;opt_interventions&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                        <span class="s1">&#39;convergence&#39;</span> <span class="p">:</span> <span class="p">[],</span>
                        <span class="s1">&#39;vas_regions&#39;</span> <span class="p">:</span> <span class="p">[]}</span>
        <span class="k">if</span> <span class="n">above_ul</span><span class="p">:</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;opt_above_ul&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">intervention_col</span><span class="p">,</span><span class="n">space_col</span><span class="p">,</span><span class="n">time_col</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">benefit_constraint</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">model</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;benefit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benefit_constraint</span><span class="p">)</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;opt_benefits&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">opt_df</span><span class="o">.</span><span class="n">opt_benefit_discounted</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;opt_costs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">opt_df</span><span class="o">.</span><span class="n">opt_costs_discounted</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">optimal_interventions</span><span class="p">)</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;convergence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;vas_regions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">opt_df</span>
                                               <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;opt_vals &gt; 0&quot;</span><span class="p">)</span>
                                               <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;index.get_level_values(&#39;intervention&#39;).str.contains(&#39;vas&#39;, case=False)&quot;</span><span class="p">)</span>
                                               <span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;region&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">above_ul</span><span class="p">:</span>
                <span class="n">above_ul_df</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">above_ul_col</span><span class="p">]</span>
                        <span class="c1"># .reset_index()</span>
                        <span class="c1"># # .assign(intervention = lambda df: df[intervention_col].str.lower())</span>
                        <span class="c1"># .set_index([intervention_col, space_col, time_col])</span>
                        <span class="p">)</span>

                <span class="n">opt_above_ul</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">opt_df</span><span class="p">[</span><span class="s1">&#39;opt_vals&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">above_ul_df</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

                <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;opt_above_ul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_above_ul</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">SupplyCurve</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;opt_benefits&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">full_population</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">ec_range</span><span class="p">))</span> 
                           <span class="p">,</span> <span class="n">full_population</span><span class="o">=</span><span class="n">full_population</span><span class="p">,</span>
                           <span class="n">bau</span><span class="o">=</span><span class="n">bau</span><span class="p">,</span>
                           <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                           <span class="n">ec_range</span><span class="o">=</span><span class="n">ec_range</span><span class="p">,</span>
                           <span class="n">intervention_col</span> <span class="o">=</span> <span class="n">intervention_col</span><span class="p">,</span>
                           <span class="n">space_col</span><span class="o">=</span><span class="n">space_col</span><span class="p">,</span>
                           <span class="n">time_col</span> <span class="o">=</span> <span class="n">time_col</span><span class="p">,</span>
                           <span class="n">cost_col</span><span class="o">=</span><span class="n">cost_col</span><span class="p">,</span>
                           <span class="n">benefit_col</span><span class="o">=</span><span class="n">benefit_col</span><span class="p">)</span>        


    <span class="nd">@classmethod</span>      
    <span class="k">def</span> <span class="nf">plot_supply_curve</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> 
                        <span class="n">supply_curve</span><span class="p">:</span> <span class="n">SupplyCurve</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">data</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="n">full_population</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">bau</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">all_space</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">all_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">time_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">benefit_col</span><span class="o">=</span><span class="s1">&#39;effective_coverage&#39;</span><span class="p">,</span>
                    <span class="n">cost_col</span><span class="o">=</span><span class="s1">&#39;cost&#39;</span><span class="p">,</span>
                    <span class="n">intervention_col</span><span class="o">=</span><span class="s1">&#39;intervention&#39;</span><span class="p">,</span>
                    <span class="n">space_col</span><span class="o">=</span><span class="s1">&#39;space&#39;</span><span class="p">,</span>
                    <span class="n">time_col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
                    <span class="n">ec_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">above_ul</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">above_ul_col</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">ec_thousands</span> <span class="o">=</span> <span class="mi">1_000</span><span class="p">,</span>
                    <span class="n">ul_thousands</span> <span class="o">=</span> <span class="mi">1_000</span><span class="p">,</span>
                    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">subplot_multiple</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">supply_curve</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">supply_curve</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">supply_curve</span><span class="p">(</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
                        <span class="n">full_population</span><span class="o">=</span><span class="n">full_population</span><span class="p">,</span>
                        <span class="n">bau</span><span class="o">=</span><span class="n">bau</span><span class="p">,</span>
                        <span class="n">all_space</span><span class="o">=</span><span class="n">all_space</span><span class="p">,</span>
                        <span class="n">all_time</span><span class="o">=</span><span class="n">all_time</span><span class="p">,</span>
                        <span class="n">time_subset</span><span class="o">=</span><span class="n">time_subset</span><span class="p">,</span>
                        <span class="n">benefit_col</span><span class="o">=</span><span class="n">benefit_col</span><span class="p">,</span>
                        <span class="n">cost_col</span><span class="o">=</span><span class="n">cost_col</span><span class="p">,</span>
                        <span class="n">intervention_col</span><span class="o">=</span><span class="n">intervention_col</span><span class="p">,</span>
                        <span class="n">space_col</span><span class="o">=</span><span class="n">space_col</span><span class="p">,</span>
                        <span class="n">time_col</span><span class="o">=</span><span class="n">time_col</span><span class="p">,</span>
                        <span class="n">ec_range</span><span class="o">=</span><span class="n">ec_range</span><span class="p">,</span>
                        <span class="n">above_ul</span> <span class="o">=</span> <span class="n">above_ul</span><span class="p">,</span>
                        <span class="n">above_ul_col</span><span class="o">=</span><span class="n">above_ul_col</span>
                        <span class="o">**</span><span class="n">kwargs</span>
                        <span class="p">)</span>

        <span class="n">N_ec</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">supply_curve</span><span class="o">.</span><span class="n">ec_range</span><span class="p">)</span>
        <span class="n">full_population</span> <span class="o">=</span> <span class="n">supply_curve</span><span class="o">.</span><span class="n">full_population</span>
        <span class="n">bau</span> <span class="o">=</span> <span class="n">supply_curve</span><span class="o">.</span><span class="n">bau</span>
        <span class="n">data</span><span class="o">=</span><span class="n">supply_curve</span><span class="o">.</span><span class="n">data</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">supply_curve</span><span class="o">.</span><span class="n">supply_curve</span> <span class="c1"># Now that we have all info. make `supply_curve` just the dataframe</span>

        <span class="c1"># make nan of infeasible solutions</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

        <span class="n">only_bau_opt</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;benefit == @bau&quot;</span><span class="p">)</span>

        <span class="c1"># # get places where interventions change</span>
        <span class="c1"># transitions = supply_curve[~(supply_curve[&#39;opt_interventions&#39;] == supply_curve[&#39;opt_interventions&#39;].shift(-1))]</span>

        <span class="k">def</span> <span class="nf">start_from_bau</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">only_bau_opt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SupplyCurveTransitionException</span><span class="p">(</span><span class="s2">&quot;All transitions less than BAU. Try increasing the number of points in ec_range&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">df</span>


        <span class="c1"># Now get additions of interventions by converting to set and doing difference</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">sc</span>
            <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">opt_interventions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]))</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">opt_interventions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">opt_interventions</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">int_transitions_lag</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">transitions_plus</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="p">[</span><span class="s1">&#39;int_transitions_lag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]))</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">transitions_minus</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="s1">&#39;int_transitions_lag&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]))</span>
            <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;benefit != @bau&quot;</span><span class="p">)</span>
            <span class="c1"># .pipe(start_from_bau)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">above_ul</span><span class="p">:</span>
            <span class="n">subplot_col</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subplot_col</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">):</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_col</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">subplot_multiple</span><span class="o">*</span><span class="n">subplot_col</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>


            <span class="k">if</span> <span class="n">above_ul</span><span class="p">:</span>
                <span class="n">ax0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">ax_region</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ax_region</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">sc</span><span class="p">[</span><span class="s1">&#39;opt_costs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax0</span><span class="p">)</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Effective Coverage (%)&#39;</span><span class="p">)</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()])</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">useMathText</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="o">/</span><span class="n">ec_thousands</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total Cost (x </span><span class="si">{</span><span class="n">ec_thousands</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">bau</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;If `bau` is specified, `data` must also be specified&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">supply_curve</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                                           <span class="n">supply_curve</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                                           <span class="n">supply_curve</span><span class="o">.</span><span class="n">time_col</span><span class="p">])</span>

                <span class="n">bau_ec</span><span class="p">,</span> <span class="n">bau_costs</span> <span class="o">=</span> <span class="n">BAUConstraintCreator</span><span class="p">()</span><span class="o">.</span><span class="n">bau_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bau</span><span class="p">,</span> <span class="p">[</span><span class="n">supply_curve</span><span class="o">.</span><span class="n">benefit_col</span><span class="p">,</span>
                                                                              <span class="n">supply_curve</span><span class="o">.</span><span class="n">cost_col</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

                <span class="n">ax0</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bau_ec</span><span class="o">/</span><span class="n">full_population</span><span class="p">,</span> <span class="n">bau_costs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
                <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;BAU&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">bau_ec</span><span class="o">/</span><span class="n">full_population</span><span class="p">,</span> <span class="n">bau_costs</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>  
                            <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset pixels&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

            <span class="n">opt_b</span><span class="p">,</span> <span class="n">opt_c</span> <span class="o">=</span> <span class="n">only_bau_opt</span><span class="p">[[</span><span class="s1">&#39;opt_benefits&#39;</span><span class="p">,</span> <span class="s1">&#39;opt_costs&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">ax0</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Optimum&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">opt_b</span><span class="o">/</span><span class="n">full_population</span><span class="p">,</span> <span class="n">opt_c</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span>  
                        <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset pixels&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
            <span class="n">ax0</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">opt_b</span><span class="o">/</span><span class="n">full_population</span><span class="p">,</span> <span class="n">opt_c</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">above_ul</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">sc</span><span class="p">[</span><span class="n">above_ul_col</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No above ul in the data&quot;</span><span class="p">)</span>
                <span class="c1"># Now get above_ul</span>
                <span class="n">sc</span><span class="p">[</span><span class="s1">&#39;opt_above_ul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">tick</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="o">/</span><span class="n">ul_thousands</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Population Above UL (x </span><span class="si">{</span><span class="n">ul_thousands</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()])</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Effective Coverage (%)&#39;</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">message_writer</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;transitions_plus&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;transitions_minus&#39;</span><span class="p">])</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">message</span><span class="o">=</span> <span class="s2">&quot;+ &quot;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;transitions_plus&#39;</span><span class="p">])</span> <span class="o">+</span>  <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;transitions_minus&#39;</span><span class="p">])</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>

                    <span class="c1"># ns_needed = len(message)//25</span>

                    <span class="c1"># # for i in range(ns_needed):</span>
                    <span class="c1"># #     message = message[i*25:i+25] + r&#39;-len\n&#39; + message[25+1+i:]</span>

                    <span class="k">return</span> <span class="n">message</span>

            <span class="c1"># print(sc)</span>


            <span class="p">(</span>
                <span class="n">sc</span><span class="p">[</span><span class="s1">&#39;vas_regions&#39;</span><span class="p">]</span>
                <span class="o">.</span><span class="n">explode</span><span class="p">()</span>
                <span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">yes</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> \
                    <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;vas_regions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span>
                    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
                <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;vas_regions&#39;</span><span class="p">,</span> 
                           <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
                <span class="c1"># .drop(columns=(&#39;yes&#39;, pd.NA))</span>
                <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">ax</span><span class="o">=</span><span class="n">ax_region</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab20&#39;</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="c1"># ax_region.set_xticks(sc.index.tolist())</span>
            <span class="n">ax_region</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sc</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
                                      <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ax_region</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Effective Coverage (%)&#39;</span><span class="p">)</span>
            <span class="n">ax_region</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="n">ax_region</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;VAS Regions&quot;</span><span class="p">)</span>

            <span class="n">texts</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">sc</span>
                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">message</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">message_writer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
                <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="mf">.01</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;opt_costs&#39;</span><span class="p">],</span> 
                                                <span class="n">s</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span>
                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
                <span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="p">)</span>   

            <span class="c1"># adjust_text(texts, arrowprops=dict(arrowstyle=&#39;-&gt;&#39;, color=&#39;green&#39;))</span>

            <span class="n">figtext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Note: BAU refers to a nutritional intervention of </span><span class="si">{</span><span class="n">bau</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span> \
            <span class="sa">f</span><span class="s2">&quot; Optimum solution consists of </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">only_bau_opt</span><span class="p">[</span><span class="s1">&#39;opt_interventions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">.&quot;</span> \
            <span class="s2">&quot; Vitamin A Supplementation taking place at various level of effective coverage in: &quot;</span> \
                           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">sc</span><span class="p">[</span><span class="s1">&#39;vas_regions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))))</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">txt</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">figtext</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">)))</span>

            <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax_region</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

            <span class="n">new_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">new_labels</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> 
                       <span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span><span class="p">,</span><span class="o">-</span><span class="mf">.6</span><span class="p">),</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Regions&#39;</span><span class="p">)</span>                 

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="minimod_opt.base.basesolver.BaseSolver.bau_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bau_list</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a dataframe with the name of the bau intervention. Mostly done for compatibility with other methods.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pd.DataFrame: dataframe with the name of the bau intervention</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">benefit_col</span><span class="o">=</span><span class="s1">&#39;benefits&#39;</span><span class="p">,</span> <span class="n">cost_col</span><span class="o">=</span><span class="s1">&#39;costs&#39;</span><span class="p">,</span> <span class="n">intervention_col</span><span class="o">=</span><span class="s1">&#39;intervention&#39;</span><span class="p">,</span> <span class="n">space_col</span><span class="o">=</span><span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="n">time_col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">interest_rate_cost</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">interest_rate_benefit</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">va_weight</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver_name</span><span class="o">=</span><span class="n">mip</span><span class="o">.</span><span class="n">CBC</span><span class="p">,</span> <span class="n">show_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">benefit_title</span><span class="o">=</span><span class="s1">&#39;Benefits&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The base solver for the Optimization. This sets up the basic setup of the model, which includes:
- data handling
- BAU constraint creation
- base model constraint creation</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>dataframe with benefits and cost data.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>benefit_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with benefit data. Defaults to 'benefits'.</p></td>
          <td>
                <code>&#39;benefits&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>cost_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with cost data. Defaults to 'costs'.</p></td>
          <td>
                <code>&#39;costs&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with intervention data. Defaults to 'intervention'.</p></td>
          <td>
                <code>&#39;intervention&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>space_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with space/region data . Defaults to 'space'.</p></td>
          <td>
                <code>&#39;space&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>time_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with time period data . Defaults to 'time'.</p></td>
          <td>
                <code>&#39;time&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>interest_rate_cost</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>interest rate of costs. Defaults to 0.0.</p></td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>benefit_title</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>title for benefits to use in plots and reports. Defaults to "Benefits".</p></td>
          <td>
                <code>&#39;Benefits&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p><code>BaseSolver</code> is inherited by <code>CostSolver</code> and <code>BenefitSolver</code> to then run optimizations.</p>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">benefit_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;benefits&#39;</span><span class="p">,</span>
    <span class="n">cost_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;costs&#39;</span><span class="p">,</span>
    <span class="n">intervention_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;intervention&#39;</span><span class="p">,</span>
    <span class="n">space_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;space&#39;</span><span class="p">,</span>
    <span class="n">time_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">interest_rate_cost</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Discount factor for costs</span>
    <span class="n">interest_rate_benefit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span>  <span class="c1"># Discount factor for benefits </span>
    <span class="n">va_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># VA Weight</span>
    <span class="n">sense</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># MIP optimization type (maximization or minimization)</span>
    <span class="n">solver_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">mip</span><span class="o">.</span><span class="n">CBC</span><span class="p">,</span>  <span class="c1"># Solver for MIP to use</span>
    <span class="n">show_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">benefit_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Benefits&quot;</span><span class="p">,</span>
<span class="p">):</span>       

<span class="w">    </span><span class="sd">&quot;&quot;&quot;The base solver for the Optimization. This sets up the basic setup of the model, which includes:</span>
<span class="sd">    - data handling</span>
<span class="sd">    - BAU constraint creation</span>
<span class="sd">    - base model constraint creation</span>

<span class="sd">    Args:</span>
<span class="sd">            data (pd.DataFrame): dataframe with benefits and cost data.</span>
<span class="sd">            benefit_col (str, optional): name of dataframe&#39;s column with benefit data. Defaults to &#39;benefits&#39;.</span>
<span class="sd">            cost_col (str, optional): name of dataframe&#39;s column with cost data. Defaults to &#39;costs&#39;.</span>
<span class="sd">            intervention_col (str, optional): name of dataframe&#39;s column with intervention data. Defaults to &#39;intervention&#39;.</span>
<span class="sd">            space_col (str, optional): name of dataframe&#39;s column with space/region data . Defaults to &#39;space&#39;.</span>
<span class="sd">            time_col (str, optional): name of dataframe&#39;s column with time period data . Defaults to &#39;time&#39;.</span>
<span class="sd">            interest_rate_cost (float, optional): interest rate of costs. Defaults to 0.0.</span>
<span class="sd">            benefit_title (str, optional): title for benefits to use in plots and reports. Defaults to &quot;Benefits&quot;.</span>

<span class="sd">    ``BaseSolver`` is inherited by ``CostSolver`` and ``BenefitSolver`` to then run optimizations.</span>
<span class="sd">    &quot;&quot;&quot;</span>        

    <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_cost</span> <span class="o">=</span> <span class="n">interest_rate_cost</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_benefit</span> <span class="o">=</span> <span class="n">interest_rate_benefit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">va_weight</span> <span class="o">=</span> <span class="n">va_weight</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discount_costs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_cost</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">discount_benefits</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">interest_rate_benefit</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span> <span class="o">=</span> <span class="n">benefit_title</span>

    <span class="k">if</span> <span class="n">sense</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sense</span> <span class="o">=</span> <span class="n">sense</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No Optimization Method was specified&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">solver_name</span> <span class="o">=</span> <span class="n">solver_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span> <span class="o">=</span> <span class="n">show_output</span>

    <span class="c1"># Process Data</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Processing Data...&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_data</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">intervention</span><span class="o">=</span><span class="n">intervention_col</span><span class="p">,</span>
        <span class="n">space</span><span class="o">=</span><span class="n">space_col</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="n">time_col</span><span class="p">,</span>
        <span class="n">benefits</span><span class="o">=</span><span class="n">benefit_col</span><span class="p">,</span>
        <span class="n">costs</span><span class="o">=</span><span class="n">cost_col</span><span class="p">,</span>
    <span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span> <span class="o">=</span> <span class="n">benefit_col</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span> <span class="o">=</span> <span class="n">cost_col</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span> <span class="o">=</span> <span class="n">intervention_col</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span> <span class="o">=</span> <span class="n">space_col</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_col</span> <span class="o">=</span> <span class="n">time_col</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Note]: Creating Base Model with constraints&quot;</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">minimum_benefit</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_funds</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            MiniMod Nutrition Intervention Tool</span>
<span class="s2">            Optimization Method: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sense</span><span class="p">)</span><span class="si">}</span>
<span class="s2">            Solver: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_name</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">            Show Output: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="si">}</span>

<span class="s2">            &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_output</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.plot_bau_time" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_bau_time</span><span class="p">(</span><span class="n">opt_variable</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plots benefits and costs of optimal and benchark interventions across time </p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>opt_variable</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>optimal variable to be plotted, where
b = optimal benefits
c = 'optimal costs
cdb = cumulative discounted benefits
cdc = cumulative discounted costs
cb = cumulative benefits
cc = cumulative costs</p></td>
          <td>
                <code>&#39;b&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>fig</code></td>
          <td>
                <code>matplotlib.<span title="matplotlib.figure">figure</span></code>
          </td>
          <td><p>matplotlib figure. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code>matplotlib.<span title="matplotlib.axis">axis</span></code>
          </td>
          <td><p>matplotlib axis to use. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to save the figure. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Exception</code>
          </td>
          <td><p>not one of the allowed variables for map plotting</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_bau_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">opt_variable</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                  <span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">ax</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots benefits and costs of optimal and benchark interventions across time </span>

<span class="sd">    Args:</span>
<span class="sd">        opt_variable (str, optional): optimal variable to be plotted, where</span>
<span class="sd">            b = optimal benefits</span>
<span class="sd">            c = &#39;optimal costs</span>
<span class="sd">            cdb = cumulative discounted benefits</span>
<span class="sd">            cdc = cumulative discounted costs</span>
<span class="sd">            cb = cumulative benefits</span>
<span class="sd">            cc = cumulative costs</span>
<span class="sd">        Defaults to &#39;b&#39;.</span>
<span class="sd">        fig (matplotlib.figure, optional): matplotlib figure. Defaults to None.</span>
<span class="sd">        ax (matplotlib.axis, optional):matplotlib axis to use. Defaults to None.</span>
<span class="sd">        save (str, optional): path to save the figure. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: not one of the allowed variables for map plotting</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
        <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span> <span class="o">+</span> <span class="s2">&quot; vs. BAU&quot;</span>
    <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>
        <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Costs vs. BAU&quot;</span>
    <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cdb&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_benefits&#39;</span>
        <span class="n">bau_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_benefits&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
    <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cdc&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_costs&#39;</span>
        <span class="n">bau_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_costs&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted Costs&#39;</span>
    <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_benefits&#39;</span>
        <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>      
    <span class="k">elif</span> <span class="n">opt_variable</span> <span class="o">==</span> <span class="s1">&#39;cc&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_costs&#39;</span>
        <span class="n">bau_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Costs&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not one of the allowed variables for map plotting. Try again.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">opt_variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cdb&#39;</span><span class="p">,</span> <span class="s1">&#39;cdc&#39;</span><span class="p">,</span> <span class="s1">&#39;cb&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">]:</span>

        <span class="n">bench_df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span>
            <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">time_col</span><span class="p">])</span>
            <span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">bau_col</span><span class="p">])</span>
            <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">bench_df</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span>
            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">bau_col</span><span class="p">])</span>
            <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">time_col</span><span class="p">])</span>
            <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="p">)</span>

    <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span> <span class="n">title</span><span class="p">,</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">bench_df</span><span class="p">[</span><span class="s1">&#39;bench_col&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Optimal&#39;</span><span class="p">,</span> <span class="s1">&#39;BAU&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.plot_chloropleth" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_chloropleth</span><span class="p">(</span><span class="n">intervention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimum_interest</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">map_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">intervention_bubbles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intervention_bubble_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates a chloropleth map of the specified intervention and time period for the optimal variable. 
If more than one intervention is specified, then aggregates them. If more than one time period is specified, then creates a subplots of len(time) and show each.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>intervention</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>intervention to use. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[int, list]</code>
          </td>
          <td><p>time periods to plot. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>optimum_interest</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>optimal variable to use (Options include: 'b' for optimal benefits, 'c' for optimal costs, and 'v' for optimal variable). Defaults to 'b'.</p></td>
          <td>
                <code>&#39;b&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>map_df</code></td>
          <td>
                <code>geopandas.<span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
          </td>
          <td><p>geopandas dataframe with geometry information. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>merge_key</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, list]</code>
          </td>
          <td><p>column to merge geo-dataframe. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_bubbles</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to show optimal intervention names in map. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_bubble_names</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, list]</code>
          </td>
          <td><p>key to merge on to geo dataframe. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to save map. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>Exception</code>
          </td>
          <td><p>Not one of the allowed variables for map plotting</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_chloropleth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">intervention</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">optimum_interest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                     <span class="n">map_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span>  <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">merge_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">intervention_bubbles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="n">intervention_bubble_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a chloropleth map of the specified intervention and time period for the optimal variable. </span>
<span class="sd">    If more than one intervention is specified, then aggregates them. If more than one time period is specified, then creates a subplots of len(time) and show each.</span>

<span class="sd">    Args:</span>
<span class="sd">        intervention (str, optional): intervention to use. Defaults to None.</span>
<span class="sd">        time (Union[int,list], optional): time periods to plot. Defaults to None.</span>
<span class="sd">        optimum_interest (str, optional): optimal variable to use (Options include: &#39;b&#39; for optimal benefits, &#39;c&#39; for optimal costs, and &#39;v&#39; for optimal variable). Defaults to &#39;b&#39;.</span>
<span class="sd">        map_df (geopandas.GeoDataFrame, optional): geopandas dataframe with geometry information. Defaults to None.</span>
<span class="sd">        merge_key (Union[str,list], optional): column to merge geo-dataframe. Defaults to None.</span>
<span class="sd">        intervention_bubbles (bool, optional): whether to show optimal intervention names in map. Defaults to False.</span>
<span class="sd">        intervention_bubble_names (Union[str,list], optional): key to merge on to geo dataframe. Defaults to None.</span>
<span class="sd">        save (str, optional): path to save map. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: Not one of the allowed variables for map plotting</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_interventions</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Costs&quot;</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_vals&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Interventions&quot;</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdb&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_benefits&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdc&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_discounted_costs&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted Costs&#39;</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_benefits&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>      
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cc&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;cumulative_costs&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Costs&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not one of the allowed variables for map plotting. Try again.&quot;</span><span class="p">)</span>


    <span class="n">plotter</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_chloropleth_getter</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">plotter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">,</span>
                                      <span class="n">intervention</span> <span class="o">=</span> <span class="n">intervention</span><span class="p">,</span>
                                        <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                        <span class="n">optimum_interest</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span>
                                        <span class="n">map_df</span> <span class="o">=</span> <span class="n">map_df</span><span class="p">,</span>
                                        <span class="n">merge_key</span><span class="o">=</span><span class="n">merge_key</span><span class="p">,</span>
                                        <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                                        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">,</span>
                                        <span class="n">intervention_bubbles</span> <span class="o">=</span> <span class="n">intervention_bubbles</span><span class="p">,</span>
                                        <span class="n">intervention_bubble_names</span> <span class="o">=</span> <span class="n">intervention_bubble_names</span><span class="p">,</span>
                                        <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.plot_grouped_interventions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_grouped_interventions</span><span class="p">(</span><span class="n">data_of_interest</span><span class="o">=</span><span class="s1">&#39;benefits&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">intervention_subset</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shows Optimal level of benefits or costs in a grouped bar plots for every optimally chosen variable across regions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_of_interest</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>variable to show. Defaults to 'benefits'.</p></td>
          <td>
                <code>&#39;benefits&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>title for resulting plot. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_subset</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, list]</code>
          </td>
          <td><p>subset of interventions to show on bar plot. Defaults to slice(None).</p></td>
          <td>
                <code>slice(None)</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to save the figure. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_grouped_interventions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                                <span class="n">data_of_interest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;benefits&#39;</span><span class="p">,</span> 
                                <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                <span class="n">intervention_subset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
                                <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shows Optimal level of benefits or costs in a grouped bar plots for every optimally chosen variable across regions.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_of_interest (str, optional): variable to show. Defaults to &#39;benefits&#39;.</span>
<span class="sd">        title (str, optional):title for resulting plot. Defaults to None.</span>
<span class="sd">        intervention_subset (Union[str,list], optional): subset of interventions to show on bar plot. Defaults to slice(None).</span>
<span class="sd">        save (str, optional): path to save the figure. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data_of_interest</span> <span class="o">==</span> <span class="s1">&#39;benefits&#39;</span><span class="p">:</span>
        <span class="n">col_of_interest</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
    <span class="k">elif</span> <span class="n">data_of_interest</span> <span class="o">==</span> <span class="s1">&#39;costs&#39;</span><span class="p">:</span>
        <span class="n">col_of_interest</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>

    <span class="n">p</span><span class="o">.</span><span class="n">_plot_grouped_bar</span><span class="p">(</span><span class="n">intervention_col</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                        <span class="n">space_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                        <span class="n">col_of_interest</span><span class="o">=</span> <span class="n">col_of_interest</span><span class="p">,</span>
                        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Optimal Level&quot;</span><span class="p">,</span>
                        <span class="n">intervention_subset</span><span class="o">=</span> <span class="n">intervention_subset</span><span class="p">,</span>
                        <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.plot_map_benchmark" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_map_benchmark</span><span class="p">(</span><span class="n">intervention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimum_interest</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">bench_intervention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">map_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">merge_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">intervention_in_title</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">intervention_bubbles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">intervention_bubble_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">millions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bau_intervention_bubble_names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Maps the optimal level on a map against a benchmark, optionally the BAU level chosen from <code>minimum_benefit</code> or <code>total_funds</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>intervention</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>interventions to map. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>time periods to map. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>optimum_interest</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>optimal value to use. Options include 'b' (benefits), 'c' (costs), 'v' (variables). Defaults to 'b'.</p></td>
          <td>
                <code>&#39;b&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>bench_intervention</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>interventions to use for benchmark. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>map_df</code></td>
          <td>
                <code>geopandas.<span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
          </td>
          <td><p>geo dataframe with geometry data. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>merge_key</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, list]</code>
          </td>
          <td><p>key to merge data from opt_df to geo dataframe. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to save the map. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_in_title</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if intervention name will be included in the title of the figure. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_bubbles</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if intervention bubbles. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>intervention_bubble_names</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, list]</code>
          </td>
          <td><p>names of intervention bubbles. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>millions</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if values displayed in millions. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>bau_intervention_bubble_names</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, list]</code>
          </td>
          <td><p>name for bau intervention bubble. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_map_benchmark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">intervention</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">time</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">optimum_interest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                       <span class="n">bench_intervention</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">map_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">merge_key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">intervention_in_title</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                       <span class="n">intervention_bubbles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                       <span class="n">intervention_bubble_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">millions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                       <span class="n">bau_intervention_bubble_names</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                       <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maps the optimal level on a map against a benchmark, optionally the BAU level chosen from ``minimum_benefit`` or ``total_funds``.</span>

<span class="sd">    Args:</span>
<span class="sd">        intervention (list, optional): interventions to map. Defaults to None.</span>
<span class="sd">        time (list, optional): time periods to map. Defaults to None.</span>
<span class="sd">        optimum_interest (str, optional):  optimal value to use. Options include &#39;b&#39; (benefits), &#39;c&#39; (costs), &#39;v&#39; (variables). Defaults to &#39;b&#39;.</span>
<span class="sd">        bench_intervention (list, optional): interventions to use for benchmark. Defaults to None.</span>
<span class="sd">        map_df (geopandas.GeoDataFrame, optional):  geo dataframe with geometry data. Defaults to None.</span>
<span class="sd">        merge_key (Union[str,list], optional): key to merge data from opt_df to geo dataframe. Defaults to None.</span>
<span class="sd">        save (str, optional): path to save the map. Defaults to None.</span>
<span class="sd">        intervention_in_title (bool, optional): True if intervention name will be included in the title of the figure. Defaults to True.</span>
<span class="sd">        intervention_bubbles (bool, optional): True if intervention bubbles. Defaults to False.</span>
<span class="sd">        intervention_bubble_names (Union[str,list], optional): names of intervention bubbles. Defaults to None.</span>
<span class="sd">        millions (bool, optional): True if values displayed in millions. Defaults to True.</span>
<span class="sd">        bau_intervention_bubble_names (Union[str,list], optional): name for bau intervention bubble. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">intervention</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_interventions</span>   

    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>   
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">optimal</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">bench</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_benefit&#39;</span>
        <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_costs&#39;</span>
        <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Costs&quot;</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;opt_vals&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Interventions&quot;</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdb&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_discounted_benefits&#39;</span>
        <span class="n">bench_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_benefits&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cdc&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_discounted_costs&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Discounted Costs&#39;</span>
        <span class="n">bench_col</span> <span class="o">=</span> <span class="s1">&#39;discounted_costs&#39;</span>
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_benefits&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span>   
        <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span>   
    <span class="k">elif</span> <span class="n">optimum_interest</span> <span class="o">==</span> <span class="s1">&#39;cc&#39;</span><span class="p">:</span>
        <span class="n">opt</span> <span class="o">=</span>  <span class="s1">&#39;cumulative_costs&#39;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Cumulative Costs&#39;</span>
        <span class="n">bench_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not one of the allowed variables for map plotting. Try again.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bench_intervention</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bench_intervention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_benefit</span>

    <span class="k">if</span> <span class="n">merge_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">merge_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span>

    <span class="k">if</span> <span class="n">optimum_interest</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cdb&#39;</span><span class="p">,</span> <span class="s1">&#39;cdc&#39;</span><span class="p">,</span> <span class="s1">&#39;cb&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">]:</span>

        <span class="n">bench_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span>
                                                        <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span> 
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">])</span>
                                                        <span class="p">[</span><span class="n">bench_col</span><span class="p">]</span>
                                                        <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;cumsum&#39;</span><span class="p">)))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">bench_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bench_col</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="n">bench_col</span><span class="p">])</span>

    <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span>

    <span class="k">if</span> <span class="n">intervention_in_title</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Optimal Interventions:</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">intervention</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">.05</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">plotter</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_chloropleth_getter</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

    <span class="c1"># Get min and max values for color map</span>
    <span class="n">opt_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">opt_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

    <span class="n">bench_max</span> <span class="o">=</span> <span class="n">bench_df</span><span class="p">[</span><span class="s1">&#39;bench_col&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">bench_min</span> <span class="o">=</span> <span class="n">bench_df</span><span class="p">[</span><span class="s1">&#39;bench_col&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">opt_max</span><span class="p">,</span> <span class="n">bench_max</span><span class="p">)</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">opt_min</span><span class="p">,</span> <span class="n">bench_min</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">intervention_bubbles</span><span class="p">:</span>
        <span class="n">bau_intervention_bubbles</span> <span class="o">=</span> <span class="s1">&#39;bau&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bau_intervention_bubbles</span> <span class="o">=</span> <span class="kc">False</span>


    <span class="n">plotter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span><span class="p">,</span>
                <span class="n">intervention</span> <span class="o">=</span> <span class="n">intervention</span><span class="p">,</span>
                <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                <span class="n">optimum_interest</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span>
                <span class="n">map_df</span> <span class="o">=</span> <span class="n">map_df</span><span class="p">,</span>
                <span class="n">merge_key</span><span class="o">=</span><span class="n">merge_key</span><span class="p">,</span>
                <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">optimal</span><span class="p">,</span>
                <span class="n">cax</span> <span class="o">=</span> <span class="n">cbar</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Scenario&quot;</span><span class="p">,</span>
                <span class="n">intervention_bubbles</span> <span class="o">=</span> <span class="n">intervention_bubbles</span><span class="p">,</span>
                <span class="n">intervention_bubble_names</span> <span class="o">=</span> <span class="n">intervention_bubble_names</span><span class="p">,</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span>
                <span class="n">legend_kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;orientation&#39;</span> <span class="p">:</span> <span class="s1">&#39;horizontal&#39;</span><span class="p">})</span>

    <span class="n">plotter</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">bench_df</span><span class="p">,</span>
                    <span class="n">intervention</span> <span class="o">=</span> <span class="n">bench_intervention</span><span class="p">,</span>
                    <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                    <span class="n">optimum_interest</span><span class="o">=</span> <span class="s1">&#39;bench_col&#39;</span><span class="p">,</span>
                    <span class="n">map_df</span> <span class="o">=</span> <span class="n">map_df</span><span class="p">,</span>
                    <span class="n">merge_key</span><span class="o">=</span><span class="n">merge_key</span><span class="p">,</span>
                    <span class="n">aggfunc</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">bench</span><span class="p">,</span>
                    <span class="n">show_legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;BAU* Scenario&quot;</span><span class="p">,</span>
                     <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span>
                    <span class="n">intervention_bubbles</span> <span class="o">=</span> <span class="n">bau_intervention_bubbles</span><span class="p">,</span>
                    <span class="n">intervention_bubble_names</span> <span class="o">=</span> <span class="n">bau_intervention_bubble_names</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="n">fig_text</span> <span class="o">=</span> <span class="s1">&#39;Note: Colors describe &#39;</span> <span class="o">+</span> <span class="n">title</span>

    <span class="k">if</span> <span class="n">millions</span><span class="p">:</span>
        <span class="n">fig_text</span> <span class="o">=</span> <span class="n">fig_text</span> <span class="o">+</span> <span class="s1">&#39; (in millions)&#39;</span>

    <span class="c1"># if intervention_bubble_names:</span>
    <span class="c1">#     fig_text = fig_text + &#39;\nBAU* scenario made up of &#39; + &#39;, &#39;.join(intervention_bubble_names)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">.05</span><span class="p">,</span> <span class="n">fig_text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.plot_opt_val_hist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_opt_val_hist</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A histogram of the optimally chosen interventions</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fig</code></td>
          <td>
                <code>matplotlib.<span title="matplotlib.figure">figure</span></code>
          </td>
          <td><p>figure instance to use. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code>matplotlib.<span title="matplotlib.axis">axis</span></code>
          </td>
          <td><p>axis instance to use. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to save the figure. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="matplotlib">mpl</span>.<span title="matplotlib.figure">figure</span></code>
          </td>
          <td><p>matplotlib.figure: histogram figure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_opt_val_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                      <span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                      <span class="n">ax</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                      <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A histogram of the optimally chosen interventions</span>

<span class="sd">    Args:</span>
<span class="sd">        fig (matplotlib.figure, optional): figure instance to use. Defaults to None.</span>
<span class="sd">        ax (matplotlib.axis, optional): axis instance to use. Defaults to None.</span>
<span class="sd">        save (str, optional): path to save the figure. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.figure: histogram figure</span>
<span class="sd">    &quot;&quot;&quot;</span>      

    <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="s1">&#39;opt_vals&#39;</span><span class="p">,</span>
                        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Optimal Choices&quot;</span><span class="p">,</span>
                        <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span>
                        <span class="n">ylabel</span><span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span>
                        <span class="n">axis</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
                        <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">)</span>  
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.plot_time" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_time</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative_discount</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plots optimal benefits and costs across time after model optimization</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fig</code></td>
          <td>
                <code>matplotlib.<span title="matplotlib.figure">figure</span></code>
          </td>
          <td><p>matplotlib figure. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code>matplotlib.<span title="matplotlib.axis">axis</span></code>
          </td>
          <td><p>matplotlib axis to use. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>save</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to save the figure. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cumulative</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to plot cumulative benefits or costs. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>cumulative_discount</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to plot cumulative benefits or costs, discounted. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="matplotlib">mpl</span>.<span title="matplotlib.figure">figure</span></code>
          </td>
          <td><p>matplotlib.figure: figure with optimal benefits and cost across time</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
              <span class="n">fig</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
              <span class="n">ax</span><span class="p">:</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
              <span class="n">cumulative_discount</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">mpl</span><span class="o">.</span><span class="n">figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots optimal benefits and costs across time after model optimization</span>

<span class="sd">    Args:</span>
<span class="sd">        fig (matplotlib.figure, optional): matplotlib figure. Defaults to None.</span>
<span class="sd">        ax (matplotlib.axis, optional): matplotlib axis to use. Defaults to None.</span>
<span class="sd">        save (str, optional): path to save the figure. Defaults to None.</span>
<span class="sd">        cumulative (bool, optional): whether to plot cumulative benefits or costs. Defaults to False.</span>
<span class="sd">        cumulative_discount (bool, optional): whether to plot cumulative benefits or costs, discounted. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.figure: figure with optimal benefits and cost across time</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cumulative_benefits&#39;</span><span class="p">,</span> <span class="s1">&#39;cumulative_costs&#39;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Optima over Time&quot;</span><span class="p">,</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                <span class="n">twin</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">twin_ylabel</span><span class="o">=</span> <span class="s2">&quot;Currency&quot;</span><span class="p">,</span>
                <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">,</span>
                <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cumm. &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                        <span class="s1">&#39;Cumm. Costs&#39;</span><span class="p">],</span>
                <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cumulative_discount</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cumulative_discounted_benefits&#39;</span><span class="p">,</span> <span class="s1">&#39;cumulative_discounted_costs&#39;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Optima over Time&quot;</span><span class="p">,</span>
                <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                <span class="n">twin</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">twin_ylabel</span><span class="o">=</span> <span class="s2">&quot;Currency&quot;</span><span class="p">,</span>
                <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">,</span>
                <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cumm. Dis. &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                        <span class="s1">&#39;Cumm. Dis. Costs&#39;</span><span class="p">],</span>
                <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">_plot_lines</span><span class="p">(</span><span class="n">to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;opt_benefit&#39;</span><span class="p">,</span> <span class="s1">&#39;opt_costs&#39;</span><span class="p">],</span>
                            <span class="n">title</span><span class="o">=</span> <span class="s2">&quot;Optima over Time&quot;</span><span class="p">,</span>
                            <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span>
                            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                            <span class="n">twin</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">twin_ylabel</span><span class="o">=</span> <span class="s2">&quot;Currency&quot;</span><span class="p">,</span>
                            <span class="n">save</span> <span class="o">=</span> <span class="n">save</span><span class="p">,</span>
                            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Optimal &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">benefit_title</span><span class="p">,</span>
                                    <span class="s1">&#39;Optimal Costs&#39;</span><span class="p">],</span>
                            <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                            <span class="n">axis</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.process_results" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process_results</span><span class="p">(</span><span class="n">sol_num</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Processes results of optimization to be used in visualization and reporting functions</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sol_num</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>index of solution. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">process_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_num</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Processes results of optimization to be used in visualization and reporting functions</span>

<span class="sd">    Args:</span>
<span class="sd">        sol_num (int, optional): index of solution. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">process_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span><span class="p">,</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span><span class="p">,</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                                        <span class="n">sol_num</span><span class="o">=</span><span class="n">sol_num</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.report" class="doc doc-heading">
<code class="highlight language-python"><span class="n">report</span><span class="p">(</span><span class="n">sol_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prints out a report of optimal model parameters and useful statistics.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sol_num</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>index of solution to be displayed. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>quiet</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether we want the report printed out or not. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol_num</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints out a report of optimal model parameters and useful statistics.</span>

<span class="sd">    Args:</span>
<span class="sd">        sol_num (int, optional): index of solution to be displayed. Defaults to None.</span>
<span class="sd">        quiet (bool, optional): whether we want the report printed out or not. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">opt_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">process_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">benefit_col</span><span class="p">,</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">cost_col</span><span class="p">,</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">intervention_col</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">space_col</span><span class="p">,</span>
                                        <span class="n">sol_num</span><span class="o">=</span><span class="n">sol_num</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;MiniMod Solver Results&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Method:&quot;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sense</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;Solver:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_name</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;Optimization Status:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;Number of Solutions Found:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_solutions</span><span class="p">))</span>

    <span class="p">]</span>

    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;No. of Variables:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cols</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;No. of Integer Variables:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_int</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;No. of Constraints&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;No. of Non-zeros in Constr.&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_nz</span><span class="p">))</span>
    <span class="p">]</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">OptimizationSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">s</span><span class="o">.</span><span class="n">print_generic</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Interventions Chosen:&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.basesolver.BaseSolver.write" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;model.lp&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Save model to file</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of the file. Defaults to "model.lp".</p></td>
          <td>
                <code>&#39;model.lp&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/basesolver.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s2">&quot;model.lp&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save model to file</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str, optional):name of the file. Defaults to &quot;model.lp&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="minimod_opt.base.bau_constraint"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="minimod_opt.base.bau_constraint.BAUConstraintCreator" class="doc doc-heading">
        <code>BAUConstraintCreator</code>


</h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>minimod_opt/base/bau_constraint.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BAUConstraintCreator</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">bau_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A dataframe of costs and benefits for the BAU (business as usual) intervention</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pandas.DataFrame): input data</span>
<span class="sd">            constraint (str): name of dataframe BAU column</span>
<span class="sd">            discounted_variable (str, optional): outputs a series of the variable of interest. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">discounted_variable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">discounted_variable</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>

        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
         <span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">constraint</span><span class="p">,</span> 
               <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> 
               <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)),:][</span><span class="n">discounted_variable</span><span class="p">]</span>
         <span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>


    <span class="k">def</span> <span class="nf">create_bau_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">over</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function sums the values of each column in the given dataframe. </span>
<span class="sd">            If the option `over&#39; is provided, the function sums across groups as well</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pandas.DataFrame): input data</span>
<span class="sd">            constraint (str): name of dataframe&#39;s column with information BAU</span>
<span class="sd">            discounted_variable (str): column of interest.</span>
<span class="sd">            over (str, optional): name of dataframe&#39;s column  with attribute used to group data by (e.g., time, region). Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: dataframe with the sum of values for each column-group</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">if</span> <span class="n">over</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimum_constraint</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">)</span>
                <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minimum_constraint</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">)</span>
                <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">over</span><span class="p">)</span>
                <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">minimum_constraint</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.bau_constraint.BAUConstraintCreator.bau_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bau_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A dataframe of costs and benefits for the BAU (business as usual) intervention</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>pandas.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>input data</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>constraint</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe BAU column</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>discounted_variable</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>outputs a series of the variable of interest. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>pandas.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pandas.DataFrame</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/bau_constraint.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bau_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A dataframe of costs and benefits for the BAU (business as usual) intervention</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): input data</span>
<span class="sd">        constraint (str): name of dataframe BAU column</span>
<span class="sd">        discounted_variable (str, optional): outputs a series of the variable of interest. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">discounted_variable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">discounted_variable</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>

    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span>
     <span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">constraint</span><span class="p">,</span> 
           <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> 
           <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)),:][</span><span class="n">discounted_variable</span><span class="p">]</span>
     <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="minimod_opt.base.bau_constraint.BAUConstraintCreator.create_bau_constraint" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_bau_constraint</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">,</span> <span class="n">over</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function sums the values of each column in the given dataframe. 
    If the option `over' is provided, the function sums across groups as well</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>pandas.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>input data</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>constraint</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column with information BAU</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>discounted_variable</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>column of interest.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>over</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name of dataframe's column  with attribute used to group data by (e.g., time, region). Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>pandas.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pandas.DataFrame: dataframe with the sum of values for each column-group</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>minimod_opt/base/bau_constraint.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_bau_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">constraint</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">over</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function sums the values of each column in the given dataframe. </span>
<span class="sd">        If the option `over&#39; is provided, the function sums across groups as well</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pandas.DataFrame): input data</span>
<span class="sd">        constraint (str): name of dataframe&#39;s column with information BAU</span>
<span class="sd">        discounted_variable (str): column of interest.</span>
<span class="sd">        over (str, optional): name of dataframe&#39;s column  with attribute used to group data by (e.g., time, region). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: dataframe with the sum of values for each column-group</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="n">over</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">minimum_constraint</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">minimum_constraint</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bau_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">discounted_variable</span><span class="p">)</span>
            <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">over</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">minimum_constraint</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 21, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tabs", "content.code.annotate"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
    
  </body>
</html>